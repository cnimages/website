


<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<title>ÊâãÊääÊâã‰ªéÈõ∂ÈÉ®ÁΩ≤‰∏éËøêËê•Áîü‰∫ßÁ∫ßÁöÑ Kubernetes ÈõÜÁæ§‰∏é KubeSphere</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="KubeSphere ÊòØÂú® Kubernetes ‰πã‰∏äÊûÑÂª∫ÁöÑ‰ª•Â∫îÁî®‰∏∫‰∏≠ÂøÉÁöÑÂ§öÁßüÊà∑ÂÆπÂô®Âπ≥Âè∞ÔºåÊèê‰æõÂÖ®Ê†àÁöÑ IT Ëá™Âä®ÂåñËøêÁª¥ÁöÑËÉΩÂäõÔºåÁÆÄÂåñ‰ºÅ‰∏öÁöÑ DevOps Â∑•‰ΩúÊµÅ„ÄÇKubeSphere Êèê‰æõ‰∫ÜËøêÁª¥ÂèãÂ•ΩÁöÑÂêëÂØºÂºèÊìç‰ΩúÁïåÈù¢ÔºåÂ∏ÆÂä©‰ºÅ‰∏öÂø´ÈÄüÊûÑÂª∫‰∏Ä‰∏™Âº∫Â§ßÂíåÂäüËÉΩ‰∏∞ÂØåÁöÑÂÆπÂô®‰∫ëÂπ≥Âè∞„ÄÇ">
<meta name="keywords" content="KubeSphere, Kubernetes, ÂÆπÂô®Âπ≥Âè∞, DevOps, Ê∑∑Âêà‰∫ë">

<meta property="og:type" content="article"/>
<meta property="og:title" content="ÊâãÊääÊâã‰ªéÈõ∂ÈÉ®ÁΩ≤‰∏éËøêËê•Áîü‰∫ßÁ∫ßÁöÑ Kubernetes ÈõÜÁæ§‰∏é KubeSphere"/>
<meta property="og:description" content="KubeSphere ÊòØÂú® Kubernetes ‰πã‰∏äÊûÑÂª∫ÁöÑ‰ª•Â∫îÁî®‰∏∫‰∏≠ÂøÉÁöÑÂ§öÁßüÊà∑ÂÆπÂô®Âπ≥Âè∞ÔºåÊèê‰æõÂÖ®Ê†àÁöÑ IT Ëá™Âä®ÂåñËøêÁª¥ÁöÑËÉΩÂäõÔºåÁÆÄÂåñ‰ºÅ‰∏öÁöÑ DevOps Â∑•‰ΩúÊµÅ„ÄÇKubeSphere Êèê‰æõ‰∫ÜËøêÁª¥ÂèãÂ•ΩÁöÑÂêëÂØºÂºèÊìç‰ΩúÁïåÈù¢ÔºåÂ∏ÆÂä©‰ºÅ‰∏öÂø´ÈÄüÊûÑÂª∫‰∏Ä‰∏™Âº∫Â§ßÂíåÂäüËÉΩ‰∏∞ÂØåÁöÑÂÆπÂô®‰∫ëÂπ≥Âè∞„ÄÇ"/>
<meta property="og:image" content="https://92uu-blog.oss-cn-beijing.aliyuncs.com/2020-03-25-091655.png"/>
<meta property="og:url" content="https://kubesphere-v3.netlify.app/zh/blogs/kubernetes-kubesphere-ha/"/>

<meta name="docsearch:language" content="zh-CN" /><link rel="stylesheet" href="/fonts/Roboto/stylesheet.css">
<link rel="stylesheet" href="/fonts/ProximaNova/stylesheet.css">
<link rel="stylesheet" href="/css/jquery.modal.min.css">
<link rel="stylesheet" href="/css/viewer.min.css">


<link rel="stylesheet" href="/scss/common.min.fd2f2584615728a729ee87ecf658d2f2e62d4c55dc6ca4c90029116aa21ee2e8.css">











<script src='/js/jquery-3.5.0.min.js'></script>
<script src='/js/viewer.min.js'></script>
<script src='/js/jquery.modal.min.js'></script>










<script type='text/javascript'>
!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement("script"),tag=t.getElementsByTagName("script")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,"script","assets.giocdn.com/2.1/gio.js","gio");
  gio('init', '8a24ae300cbf8b8c', {});
  
  
  gio('send');
</script>





    <link rel="stylesheet" href="/scss/content.min.cd01785de7a83de330d32ac3aef7e5f4e0aa8c5e62c21008e4779016e3fd9517.css">
    
    
    <link rel="stylesheet" href="/scss/markdown.min.0de31cde2c91847e0e6c6f43d52658e6347b056a9da347546c21a7786900bfcf.css">
</head>


<body>
   
  
<header class="navigation">
    
    <div class="join-div">
        <div class="content">
            üöÄ KubeSphere v3.0.0 Ê≠£Âºè GAÔºÅ<a href="https://www.qingcloud.com/kubesphere2020#tz2" target="_blank" rel="noopener noreferrer">ÂÖçË¥πÂõûÁúã v3.0 ÂèëÂ∏É‰ºöËßÜÈ¢ë üì∫</a>
            <a href="https://kubesphere.com.cn/forum/d/2062-awesome-kubesphere-kubesphere-3-0" target="_blank" rel="noopener noreferrer">‰∫ÜËß£‰∏ÄÈîÆÂø´ÈÄüÂÆâË£ÖÂÖ•Èó®ÁöÑÊúÄ‰Ω≥ÊñπÂºèüìö ‚Üí</a>
            <img id="close-join" src="/images/header/close.svg" alt="close">
        </div>
    </div>
    
    <div class="common-layout">
        <div class="header-container">
            <a href="/zh/">
                <img src="/images/header/logo.svg" alt="" class="logo">
            </a>

            <ul class="nav">
                
                
                

                
                
                    
                
                    
                
                    
                

                <li  class="menu-li" >
                    <span class='menu-span'>Â∫îÁî®Âú∫ÊôØ</span>
                    <ul class="dropdown-menu menu-2">
                        
                        <li >
                            
                            <a href="/zh/devops/">Êã•Êä±‰∏ÄÁ´ôÂºè DevOps Â∑•‰ΩúÊµÅ</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/service-mesh/">Âú® Kubernetes ËøêË°åÂæÆÊúçÂä°</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/observability/">ÊûÑÂª∫‰∏∞ÂØåÁöÑ‰∫ëÂéüÁîüÂèØËßÇÂØüÊÄß</a>
                            
                        </li>
                        
                    </ul>
                </li>
                

                
                

                
                
                    
                
                    
                
                    
                
                    
                

                <li  class="menu-li" >
                    <span class='menu-span'>ËµÑÊ∫ê</span>
                    <ul class="dropdown-menu menu-3">
                        
                        <li >
                            
                            <a href="/zh/projects/">ÂºÄÊ∫êÈ°πÁõÆ</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/conferences/">ÂºÄÊ∫êÂ≥∞‰ºö</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/blogs/">ÊäÄÊúØÂçöÂÆ¢</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/videos/">ËßÜÈ¢ëËµÑÊ∫ê</a>
                            
                        </li>
                        
                    </ul>
                </li>
                

                
                

                
                
                    
                
                    
                
                    
                
                    
                

                <li  class="menu-li" >
                    <span class='menu-span'>ÊñáÊ°£‰∏≠ÂøÉ</span>
                    <ul class="dropdown-menu menu-4">
                        
                        <li >
                            
                            <a href="/zh/docs/">v3.0.0 <img src='/images/header/star.svg' alt='star'></a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="https://v2-1.docs.kubesphere.io/docs/zh-CN/" target="_blank" rel="noopener noreferrer">v2.1.x</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="https://v2-0.docs.kubesphere.io/docs/zh-CN/" target="_blank" rel="noopener noreferrer">v2.0.x</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="https://v1-0.docs.kubesphere.io/docs/zh-CN/" target="_blank" rel="noopener noreferrer">v1.0.0</a>
                            
                        </li>
                        
                    </ul>
                </li>
                

                
                

                
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                

                <li  class="menu-li" >
                    <span class='menu-span'>ÂºÄÊ∫êÁ§æÂå∫</span>
                    <ul class="dropdown-menu menu-5">
                        
                        <li >
                            
                            <a href="/zh/contribution/">ÂèÇ‰∏éË¥°ÁåÆ</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/case/">Ê°à‰æãÂ≠¶‰π†</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/partner/">Âêà‰Ωú‰ºô‰º¥</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="/zh/news/">Âä®ÊÄÅ</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md" target="_blank" rel="noopener noreferrer">ÁâàÊú¨ËÆ°Âàí</a>
                            
                        </li>
                        
                        <li >
                            
                            <a href="https://kubesphere.com.cn/" target="_blank" rel="noopener noreferrer">‰∏≠ÂõΩÁ´ô</a>
                            
                        </li>
                        
                    </ul>
                </li>
                

                
                
                <li >
                    
                    <a data-docs="Áî®Êà∑ËÆ∫Âùõ" href="https://kubesphere.com.cn/forum" target="_blank" rel="noopener noreferrer">Áî®Êà∑ËÆ∫Âùõ</a>
                    
                </li>
                

                

            </ul>
            <div class="right-menu">
                <ul>
                    <li class="language-menu">
                        <div>
                            <img src="/images/header/black.svg" alt="">
                            <span>ÁÆÄ‰Ωì‰∏≠Êñá</span>
                        </div>
                        
                        <ul class="dropdown-menu">
                            
                            <li onclick="location = '\/zh\/blogs\/kubernetes-kubesphere-ha\/'">ÁÆÄ‰Ωì‰∏≠Êñá</li>
                            
                        </ul>
                        
                    </li>
                    <li class='btn-li'>
                        <a href="https://demo.kubesphere.io/login" target="_blank" rel="noopener noreferrer">
                            <button class="demo-btn">Demo ‚Üí</button>
                        </a>
                        <ol class="dropdown-menu">
                            <li>1.‰ΩìÈ™åË¥¶Âè∑Ôºö demo1 / Demo123</li>
                            <li>2.ËØ•Ë¥¶Âè∑‰ªÖÂºÄÊîæ‰∫ÜÈÉ®ÂàÜ UI ÁïåÈù¢Êü•ÁúãÊùÉÈôê</li>
                            <li>3.Âª∫ËÆÆËá™Ë°åÂÆâË£Ö‰ΩìÈ™åÂÆåÊï¥ÁöÑÁÆ°ÁêÜÂäüËÉΩ</li>
                        </ol>
                    </li>
                    <li class='link-li'>
                        <a class='link-1' href="https://join.slack.com/t/kubesphere/shared_invite/enQtNTE3MDIxNzUxNzQ0LTZkNTdkYWNiYTVkMTM5ZThhODY1MjAyZmVlYWEwZmQ3ODQ1NmM1MGVkNWEzZTRhNzk0MzM5MmY4NDc3ZWVhMjE" target="_blank" rel="noopener noreferrer"></a>
                        <a class='link-2' href="https://twitter.com/KubeSphere" target="_blank" rel="noopener noreferrer"></a>
                        <a class='link-3' href="https://github.com/kubesphere/kubesphere" target="_blank" rel="noopener noreferrer"></a>
                    </li>
                    <li class="menu-icon">
                        <img src="/images/header/menu.svg" alt="">
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div id="modal-for-menu" class="modal">
        <ul class="nav">
            
            
            

            
            
                
            
                
            
                
            

            <li data-check="0"  class="menu-li" >
                <span class='menu-span'>Â∫îÁî®Âú∫ÊôØ</span>
                <ul class="dropdown-menu">
                    
                    <li >
                        <a href="/zh/devops/">Êã•Êä±‰∏ÄÁ´ôÂºè DevOps Â∑•‰ΩúÊµÅ</a>
                    </li>
                    
                    <li >
                        <a href="/zh/service-mesh/">Âú® Kubernetes ËøêË°åÂæÆÊúçÂä°</a>
                    </li>
                    
                    <li >
                        <a href="/zh/observability/">ÊûÑÂª∫‰∏∞ÂØåÁöÑ‰∫ëÂéüÁîüÂèØËßÇÂØüÊÄß</a>
                    </li>
                    
                </ul>
            </li>
            

            
            

            
            
                
            
                
            
                
            
                
            

            <li data-check="0"  class="menu-li" >
                <span class='menu-span'>ËµÑÊ∫ê</span>
                <ul class="dropdown-menu">
                    
                    <li >
                        <a href="/zh/projects/">ÂºÄÊ∫êÈ°πÁõÆ</a>
                    </li>
                    
                    <li >
                        <a href="/zh/conferences/">ÂºÄÊ∫êÂ≥∞‰ºö</a>
                    </li>
                    
                    <li >
                        <a href="/zh/blogs/">ÊäÄÊúØÂçöÂÆ¢</a>
                    </li>
                    
                    <li >
                        <a href="/zh/videos/">ËßÜÈ¢ëËµÑÊ∫ê</a>
                    </li>
                    
                </ul>
            </li>
            

            
            

            
            
                
            
                
            
                
            
                
            

            <li data-check="0"  class="menu-li" >
                <span class='menu-span'>ÊñáÊ°£‰∏≠ÂøÉ</span>
                <ul class="dropdown-menu">
                    
                    <li >
                        <a href="/zh/docs/">v3.0.0 <img src='/images/header/star.svg' alt='star'></a>
                    </li>
                    
                    <li >
                        <a href="https://v2-1.docs.kubesphere.io/docs/zh-CN/">v2.1.x</a>
                    </li>
                    
                    <li >
                        <a href="https://v2-0.docs.kubesphere.io/docs/zh-CN/">v2.0.x</a>
                    </li>
                    
                    <li >
                        <a href="https://v1-0.docs.kubesphere.io/docs/zh-CN/">v1.0.0</a>
                    </li>
                    
                </ul>
            </li>
            

            
            

            
            
                
            
                
            
                
            
                
            
                
            
                
            

            <li data-check="0"  class="menu-li" >
                <span class='menu-span'>ÂºÄÊ∫êÁ§æÂå∫</span>
                <ul class="dropdown-menu">
                    
                    <li >
                        <a href="/zh/contribution/">ÂèÇ‰∏éË¥°ÁåÆ</a>
                    </li>
                    
                    <li >
                        <a href="/zh/case/">Ê°à‰æãÂ≠¶‰π†</a>
                    </li>
                    
                    <li >
                        <a href="/zh/partner/">Âêà‰Ωú‰ºô‰º¥</a>
                    </li>
                    
                    <li >
                        <a href="/zh/news/">Âä®ÊÄÅ</a>
                    </li>
                    
                    <li >
                        <a href="https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md">ÁâàÊú¨ËÆ°Âàí</a>
                    </li>
                    
                    <li >
                        <a href="https://kubesphere.com.cn/">‰∏≠ÂõΩÁ´ô</a>
                    </li>
                    
                </ul>
            </li>
            

            
            
            <li ><a data-docs="Áî®Êà∑ËÆ∫Âùõ" href="https://kubesphere.com.cn/forum">Áî®Êà∑ËÆ∫Âùõ</a></li>
            

            

        </ul>
        <div class="btn-div">
            <a href="https://demo.kubesphere.io/login" target="_blank" rel="noopener noreferrer">
                <button class="demo-btn">Demo ‚Üí</button>
            </a>
        </div>
        <div class="link-div">
            <a href="https://join.slack.com/t/kubesphere/shared_invite/enQtNTE3MDIxNzUxNzQ0LTZkNTdkYWNiYTVkMTM5ZThhODY1MjAyZmVlYWEwZmQ3ODQ1NmM1MGVkNWEzZTRhNzk0MzM5MmY4NDc3ZWVhMjE" target="_blank" rel="noopener noreferrer">
                <img src="/images/header/slack-hover.svg" alt="">
            </a>
            <a href="https://twitter.com/KubeSphere" target="_blank" rel="noopener noreferrer">
                <img src="/images/header/twitter-hover.svg" alt="">
            </a>
            <a href="https://github.com/kubesphere/kubesphere" target="_blank" rel="noopener noreferrer">
                <img src="/images/header/github-hover.svg" alt="">
            </a>
        </div>
    </div>
</header>
<script>
var bindNavMouseEvent = function(selector) {
    var flag = false
    $(selector).mouseenter(function() {
        if (flag) {
            return false
        }
        flag = true
        $(this).find('.dropdown-menu').fadeIn(200, function() {
            flag = false
        })
    });
    $(selector).mouseleave(function() {
        $(this).find('.dropdown-menu').fadeOut(200)
    });
}

var bindScrollChangeHeader = function() {
    var check = 100
    var header = $('header')
    window.addEventListener('scroll', function() {
        var scrollY = window.scrollY;
        if (scrollY > 100) {
            header.addClass('navigationScroll')
        } else {
            header.removeClass('navigationScroll')
        }
    })
}

var bindClickShowMenu = function() {
    $('.menu-icon').click(function() {
        $('#modal-for-menu').modal()
    })
}

var bindClickModalLi = function() {
    $('.modal .menu-li').click(function() {
        var check = $(this).data('check')
        if (check === 0) {
            $(this).data('check', 1)
            $(this).find('.dropdown-menu').slideDown(200)
        } else {
            $(this).data('check', 0)
            $(this).find('.dropdown-menu').slideUp(200)
        }
        $(this).find('.menu-span').toggleClass('up')
    })
}

var bindClickClose = function() {
    $('#close-join').click(function() {
        $('.navigation .join-div').hide()
        $('.main-section').removeClass('padding')
    })
}

var language = 'zh'

bindClickClose()

bindScrollChangeHeader()

bindNavMouseEvent('.header-container .menu-li')
bindNavMouseEvent('.header-container .language-menu')
bindNavMouseEvent('.header-container .btn-li')

bindClickShowMenu()
bindClickModalLi()


</script>

  <section class="main-section  padding">
      <div class="common-layout">
          <div class='breadcrumb'>
              
              <span><a href='/zh/blogs'>ÊäÄÊúØÂçöÂÆ¢</a> > </span>
              <span>ÊâãÊääÊâã‰ªéÈõ∂ÈÉ®ÁΩ≤‰∏éËøêËê•Áîü‰∫ßÁ∫ßÁöÑ Kubernetes ÈõÜÁæ§‰∏é KubeSphere</span>
          </div>
          <div class='main-div middle-div'>
              <div class='author'>Liu_wt</div>
              <div class='date'>ÂèëÂ∏É‰∫éÔºö2020-03-26</div>
              <h1>ÊâãÊääÊâã‰ªéÈõ∂ÈÉ®ÁΩ≤‰∏éËøêËê•Áîü‰∫ßÁ∫ßÁöÑ Kubernetes ÈõÜÁæ§‰∏é KubeSphere</h1>
              <div class="share-1">
                  <div class="share">
  <a href="http://twitter.com/share?url=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f&text=%e6%89%8b%e6%8a%8a%e6%89%8b%e4%bb%8e%e9%9b%b6%e9%83%a8%e7%bd%b2%e4%b8%8e%e8%bf%90%e8%90%a5%e7%94%9f%e4%ba%a7%e7%ba%a7%e7%9a%84%20Kubernetes%20%e9%9b%86%e7%be%a4%e4%b8%8e%20KubeSphere" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Twitter.svg" alt="twitter icon">
  </a>
  <a href="http://reddit.com/submit?url=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e4%bb%8e%e9%9b%b6%e9%83%a8%e7%bd%b2%e4%b8%8e%e8%bf%90%e8%90%a5%e7%94%9f%e4%ba%a7%e7%ba%a7%e7%9a%84%20Kubernetes%20%e9%9b%86%e7%be%a4%e4%b8%8e%20KubeSphere" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Reddit.svg" alt="reddit icon">
  </a>
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Facebook.svg" alt="facebook icon">
  </a>
  <a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Linkedin.svg" alt="linkedin icon">
  </a>
  <a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f&t=%e6%89%8b%e6%8a%8a%e6%89%8b%e4%bb%8e%e9%9b%b6%e9%83%a8%e7%bd%b2%e4%b8%8e%e8%bf%90%e8%90%a5%e7%94%9f%e4%ba%a7%e7%ba%a7%e7%9a%84%20Kubernetes%20%e9%9b%86%e7%be%a4%e4%b8%8e%20KubeSphere" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/HackerNews.svg" alt="hackernews icon">
  </a>
</div>
              </div>
              <div class='content'>
                  <div class='md-body'>
                      <p><img src="https://pek3b.qingstor.com/kubesphere-docs/png/20200327191533.png" alt=""></p>
<blockquote>
<p>Êú¨ÊñáÊù•Ëá™ KubeSphere Á§æÂå∫Áî®Êà∑ <strong>Liu_wt</strong> ÊäïÁ®øÔºåÊ¨¢ËøéÊâÄÊúâÁ§æÂå∫Áî®Êà∑ÂèÇ‰∏éÊäïÁ®øÊàñÂàÜ‰∫´ÁªèÈ™åÊ°à‰æã„ÄÇ</p>
</blockquote>
<p>Êú¨ÊñáÂ∞Ü‰ªéÈõ∂ÂºÄÂßãÔºåÂú®Âπ≤ÂáÄÁöÑÊú∫Âô®‰∏äÂÆâË£Ö Docker„ÄÅKubernetes (‰ΩøÁî® kubeadm)„ÄÅCalico„ÄÅHelm ‰∏é KubeSphereÔºåÈÄöËøáÊâãÊääÊâãÁöÑÊïôÁ®ãÊºîÁ§∫Â¶Ç‰ΩïÊê≠Âª∫‰∏Ä‰∏™È´òÂèØÁî®Áîü‰∫ßÁ∫ßÁöÑ KubernetesÔºåÂπ∂Âú® Kubernetes ÈõÜÁæ§‰πã‰∏äÂÆâË£Ö KubeSphere ÂÆπÂô®Âπ≥Âè∞ÂèØËßÜÂåñËøêËê•ÈõÜÁæ§ÁéØÂ¢É„ÄÇ</p>
<h2 id="‰∏ÄÂáÜÂ§áÁéØÂ¢É">‰∏Ä„ÄÅÂáÜÂ§áÁéØÂ¢É</h2>
<p>ÂºÄÂßãÈÉ®ÁΩ≤‰πãÂâçÔºåËØ∑ÂÖàÁ°ÆÂÆöÂΩìÂâçÊª°Ë∂≥Â¶Ç‰∏ãÊù°‰ª∂ÔºåÊú¨Ê¨°ÈõÜÁæ§Êê≠Âª∫ÔºåÊâÄÊúâÊú∫Âô®Â§Ñ‰∫éÂêå‰∏ÄÂÜÖÁΩëÁΩëÊÆµÔºåÂπ∂‰∏îÂèØ‰ª•‰∫íÁõ∏ÈÄö‰ø°„ÄÇ</p>
<p>‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èÔºö<strong>ËØ∑ËØ¶ÁªÜÈòÖËØªÁ¨¨‰∏ÄÈÉ®ÂàÜÔºåÂêéÈù¢ÁöÑÊâÄÊúâÊìç‰ΩúÈÉΩÊòØÂü∫‰∫éËøô‰∏™ÁéØÂ¢ÉÁöÑÔºå‰∏∫‰∫ÜÈÅøÂÖçÂêéÈù¢ÈÉ®ÁΩ≤ÈõÜÁæ§Âá∫Áé∞ÂêÑÁßçÂêÑÊ†∑ÁöÑÈóÆÈ¢òÔºåÂº∫ÁÉàÂª∫ËÆÆ‰Ω†ÂÆåÂÖ®Êª°Ë∂≥Á¨¨‰∏ÄÈÉ®ÂàÜÁöÑÁéØÂ¢ÉË¶ÅÊ±Ç</strong></p>
<blockquote>
<ul>
<li>‰∏§Âè∞‰ª•‰∏ä‰∏ªÊú∫</li>
<li>ÊØèÂè∞‰∏ªÊú∫ÁöÑ‰∏ªÊú∫Âêç„ÄÅMac Âú∞ÂùÄ„ÄÅUUID ‰∏çÁõ∏Âêå</li>
<li>CentOS 7ÔºàÊú¨ÊñáÁî® 7.6/7.7Ôºâ</li>
<li>ÊØèÂè∞Êú∫Âô®ÊúÄÂ•ΩÊúâ 2G ÂÜÖÂ≠òÊàñ‰ª•‰∏ä</li>
<li>Control-plane/MasterËá≥Â∞ë 2U Êàñ‰ª•‰∏ä</li>
<li>ÂêÑ‰∏™‰∏ªÊú∫‰πãÈó¥ÁΩëÁªúÁõ∏ÈÄö</li>
<li>Á¶ÅÁî®‰∫§Êç¢ÂàÜÂå∫</li>
<li>Á¶ÅÁî® SELINUX</li>
<li>ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ôÔºàÊàëËá™Â∑±ÁöÑÈÄâÊã©Ôºå‰Ω†‰πüÂèØ‰ª•ËÆæÁΩÆÁõ∏ÂÖ≥Èò≤ÁÅ´Â¢ôËßÑÂàôÔºâ</li>
<li>Control-plane/MasterÂíåWorkerËäÇÁÇπÂàÜÂà´ÂºÄÊîæÂ¶Ç‰∏ãÁ´ØÂè£</li>
</ul>
</blockquote>
<p><strong>MasterËäÇÁÇπ</strong></p>
<table>
<thead>
<tr>
<th>ÂçèËÆÆ</th>
<th>ÊñπÂêë</th>
<th>Á´ØÂè£ËåÉÂõ¥</th>
<th>‰ΩúÁî®</th>
<th>‰ΩøÁî®ËÄÖ</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>6443*</td>
<td>Kubernetes API ÊúçÂä°Âô®</td>
<td>ÊâÄÊúâÁªÑ‰ª∂</td>
</tr>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>2379-2380</td>
<td>etcd server client API</td>
<td>kube-apiserver, etcd</td>
</tr>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>10250</td>
<td>Kubelet API</td>
<td>kubelet Ëá™Ë∫´„ÄÅÊéßÂà∂Âπ≥Èù¢ÁªÑ‰ª∂</td>
</tr>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>10251</td>
<td>kube-scheduler</td>
<td>kube-scheduler Ëá™Ë∫´</td>
</tr>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>10252</td>
<td>kube-controller-manager</td>
<td>kube-controller-manager Ëá™Ë∫´</td>
</tr>
</tbody>
</table>
<p><strong>WorkerËäÇÁÇπ</strong></p>
<table>
<thead>
<tr>
<th>ÂçèËÆÆ</th>
<th>ÊñπÂêë</th>
<th>Á´ØÂè£ËåÉÂõ¥</th>
<th>‰ΩúÁî®</th>
<th>‰ΩøÁî®ËÄÖ</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>10250</td>
<td>Kubelet API</td>
<td>kubelet Ëá™Ë∫´„ÄÅÊéßÂà∂Âπ≥Èù¢ÁªÑ‰ª∂</td>
</tr>
<tr>
<td>TCP</td>
<td>ÂÖ•Á´ô</td>
<td>30000-32767</td>
<td>NodePort ÊúçÂä°**</td>
<td>ÊâÄÊúâÁªÑ‰ª∂</td>
</tr>
</tbody>
</table>
<p>ÂÖ∂‰ªñÁõ∏ÂÖ≥Êìç‰ΩúÂ¶Ç‰∏ãÔºö</p>
<blockquote>
<p>ÂèãÊÉÖÊèêÁ§∫üòäÔºåÂ¶ÇÊûúÈõÜÁæ§ËøáÂ§öÔºåÂèØ‰ª•‰∫ÜËß£‰∏ã ansibleÔºåÊâπÈáèÁÆ°ÁêÜ‰Ω†ÁöÑÂ§öÂè∞Êú∫Âô®ÔºåÊñπ‰æøÂÆûÁî®ÁöÑÂ∑•ÂÖ∑„ÄÇ</p>
</blockquote>
<p>ÂÖàËøõË°åÈò≤ÁÅ´Â¢ô„ÄÅ‰∫§Êç¢ÂàÜÂå∫ËÆæÁΩÆ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ‰∏∫‰∫ÜÊñπ‰æøÊú¨Êìç‰ΩúÂÖ≥Èó≠‰∫ÜÈò≤ÁÅ´Â¢ôÔºå‰πüÂª∫ËÆÆ‰Ω†ËøôÊ†∑Êìç‰Ωú</span>
systemctl stop firewalld
systemctl disable firewalld

<span style="color:#75715e"># ÂÖ≥Èó≠ SeLinux</span>
setenforce <span style="color:#ae81ff">0</span>
sed -i <span style="color:#e6db74">&#34;s/SELINUX=enforcing/SELINUX=disabled/g&#34;</span> /etc/selinux/config

<span style="color:#75715e"># ÂÖ≥Èó≠ swap</span>
swapoff -a
yes | cp /etc/fstab /etc/fstab_bak
cat /etc/fstab_bak |grep -v swap &gt; /etc/fstab
</code></pre></div><p>Êõ¥Êç¢CentOS YUMÊ∫ê‰∏∫ÈòøÈáå‰∫ëyumÊ∫ê</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÂÆâË£Öwget</span>
yum install wget -y
<span style="color:#75715e"># Â§á‰ªΩ</span>
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
<span style="color:#75715e"># Ëé∑ÂèñÈòøÈáå‰∫ëyumÊ∫ê</span>
wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
<span style="color:#75715e"># Ëé∑ÂèñÈòøÈáå‰∫ëepelÊ∫ê</span>
wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
<span style="color:#75715e"># Ê∏ÖÁêÜÁºìÂ≠òÂπ∂ÂàõÂª∫Êñ∞ÁöÑÁºìÂ≠ò</span>
yum clean all <span style="color:#f92672">&amp;&amp;</span> yum makecache
<span style="color:#75715e"># Á≥ªÁªüÊõ¥Êñ∞</span>
yum update -y
</code></pre></div><p>ËøõË°åÊó∂Èó¥ÂêåÊ≠•ÔºåÂπ∂Á°ÆËÆ§Êó∂Èó¥ÂêåÊ≠•ÊàêÂäü</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">timedatectl
timedatectl set-ntp true
</code></pre></div><blockquote>
<p>‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‰ª•‰∏ãÊìç‰ΩúËØ∑‰∏•Ê†ºÊåâÁÖßÂ£∞ÊòéÁöÑÁâàÊú¨ËøõË°åÈÉ®ÁΩ≤ÔºåÂê¶ÂàôÂ∞ÜÁ¢∞Âà∞‰π±‰∏ÉÂÖ´Á≥üÁöÑÈóÆÈ¢ò</p>
</blockquote>
<h1 id="‰∫åÂÆâË£Ö-docker">‰∫å„ÄÅÂÆâË£Ö Docker</h1>
<h2 id="21ÂÆâË£Ö-docker">2.1„ÄÅÂÆâË£Ö Docker</h2>
<p>ÊÇ®ÈúÄË¶ÅÂú®ÊØèÂè∞Êú∫Âô®‰∏äÂÆâË£Ö DockerÔºåÊàëËøôÈáåÂÆâË£ÖÁöÑÊòØ <code>docker-ce-19.03.4</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÂÆâË£Ö Docker CE</span>
<span style="color:#75715e"># ËÆæÁΩÆ‰ªìÂ∫ì</span>
<span style="color:#75715e"># ÂÆâË£ÖÊâÄÈúÄÂåÖ</span>
yum install -y yum-utils <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    device-mapper-persistent-data <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    lvm2

<span style="color:#75715e"># Êñ∞Â¢û Docker ‰ªìÂ∫ì,ÈÄüÂ∫¶ÊÖ¢ÁöÑÂèØ‰ª•Êç¢ÈòøÈáå‰∫ëÁöÑÊ∫ê„ÄÇ</span>
yum-config-manager <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --add-repo <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    https://download.docker.com/linux/centos/docker-ce.repo
<span style="color:#75715e"># ÈòøÈáå‰∫ëÊ∫êÂú∞ÂùÄ</span>
<span style="color:#75715e"># http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span>

<span style="color:#75715e"># ÂÆâË£Ö Docker CE.</span>
yum install -y containerd.io-1.2.10 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    docker-ce-19.03.4 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    docker-ce-cli-19.03.4

<span style="color:#75715e"># ÂêØÂä® Docker Âπ∂Ê∑ªÂä†ÂºÄÊú∫ÂêØÂä®</span>
systemctl start docker
systemctl enable docker
</code></pre></div><h2 id="22‰øÆÊîπ-cgroup-driver">2.2„ÄÅ‰øÆÊîπ Cgroup Driver</h2>
<p>ÈúÄË¶ÅÂ∞ÜDocker ÁöÑ Cgroup Driver ‰øÆÊîπ‰∏∫ systemdÔºå‰∏çÁÑ∂Âú®‰∏∫Kubernetes ÈõÜÁæ§Ê∑ªÂä†ËäÇÁÇπÊó∂‰ºöÊä•Â¶Ç‰∏ãÈîôËØØÔºö</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÊâßË°å kubeadm join ÁöÑ WARNING ‰ø°ÊÅØ</span>
<span style="color:#f92672">[</span>WARNING IsDockerSystemdCheck<span style="color:#f92672">]</span>: detected <span style="color:#e6db74">&#34;cgroupfs&#34;</span> as the Docker cgroup driver. The recommended driver is <span style="color:#e6db74">&#34;systemd&#34;</span>. Please follow the guide at https://kubernetes.io/docs/setup/cri/
</code></pre></div><p>ÁõÆÂâç Docker ÁöÑ Cgroup Driver ÁúãËµ∑Êù•Â∫îËØ•ÊòØËøôÊ†∑ÁöÑÔºö</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker info|grep <span style="color:#e6db74">&#34;Cgroup Driver&#34;</span>
  Cgroup Driver: cgroupfs
</code></pre></div><p>ÈúÄË¶ÅÂ∞ÜËøô‰∏™ÂÄº‰øÆÊîπ‰∏∫ systemd ÔºåÂêåÊó∂ÊàëÂ∞ÜregistryÊõøÊç¢ÊàêÂõΩÂÜÖÁöÑ‰∏Ä‰∫õ‰ªìÂ∫ìÂú∞ÂùÄÔºå‰ª•ÂÖçÁõ¥Êé•Âú®ÂÆòÊñπ‰ªìÂ∫ìÊãâÂèñÈïúÂÉè‰ºöÂæàÊÖ¢ÔºåÊìç‰ΩúÂ¶Ç‰∏ã„ÄÇ</p>
<blockquote>
<p>‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èÔºöÊ≥®ÊÑèÁº©ËøõÔºåÁõ¥Êé•Â§çÂà∂ÁöÑÁº©ËøõÂèØËÉΩÊúâÈóÆÈ¢òÔºåËØ∑Á°Æ‰øùÁº©Ëøõ‰∏∫Ê≠£Á°ÆÁöÑ Json Ê†ºÂºèÔºõÂ¶ÇÊûú Docker ÈáçÂêØÂêéÊü•ÁúãÁä∂ÊÄÅ‰∏çÊ≠£Â∏∏ÔºåÂ§ßÊ¶ÇÁéáÊòØÊ≠§Êñá‰ª∂Áº©ËøõÊúâÈóÆÈ¢òÔºåJsonÊ†ºÂºèÁöÑÁº©ËøõËá™Â∑±‰∫ÜËß£‰∏Ä‰∏ã„ÄÇ</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Setup daemon.</span>
cat &gt; /etc/docker/daemon.json <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">{
</span><span style="color:#e6db74">    &#34;exec-opts&#34;: [&#34;native.cgroupdriver=systemd&#34;],
</span><span style="color:#e6db74">    &#34;log-driver&#34;: &#34;json-file&#34;,
</span><span style="color:#e6db74">    &#34;log-opts&#34;: {
</span><span style="color:#e6db74">    &#34;max-size&#34;: &#34;100m&#34;
</span><span style="color:#e6db74">    },
</span><span style="color:#e6db74">    &#34;storage-driver&#34;: &#34;overlay2&#34;,
</span><span style="color:#e6db74">    &#34;registry-mirrors&#34;:[
</span><span style="color:#e6db74">        &#34;https://kfwkfulq.mirror.aliyuncs.com&#34;,
</span><span style="color:#e6db74">        &#34;https://2lqq34jg.mirror.aliyuncs.com&#34;,
</span><span style="color:#e6db74">        &#34;https://pee6w651.mirror.aliyuncs.com&#34;,
</span><span style="color:#e6db74">        &#34;http://hub-mirror.c.163.com&#34;,
</span><span style="color:#e6db74">        &#34;https://docker.mirrors.ustc.edu.cn&#34;,
</span><span style="color:#e6db74">        &#34;https://registry.docker-cn.com&#34;
</span><span style="color:#e6db74">    ]
</span><span style="color:#e6db74">}
</span><span style="color:#e6db74">EOF</span>

mkdir -p /etc/systemd/system/docker.service.d

<span style="color:#75715e"># Restart docker.</span>
systemctl daemon-reload
systemctl restart docker
</code></pre></div><h1 id="‰∏âÂÆâË£Ö-kubeadmkubelet-Âíå-kubectl">‰∏â„ÄÅÂÆâË£Ö kubeadm„ÄÅkubelet Âíå kubectl</h1>
<h2 id="31ÂÆâË£ÖÂáÜÂ§á">3.1„ÄÅÂÆâË£ÖÂáÜÂ§á</h2>
<p>ÈúÄË¶ÅÂú®ÊØèÂè∞Êú∫Âô®‰∏äÂÆâË£Ö‰ª•‰∏ãÁöÑËΩØ‰ª∂ÂåÖÔºö</p>
<ul>
<li>
<p><code>kubeadm</code>ÔºöÁî®Êù•ÂàùÂßãÂåñÈõÜÁæ§ÁöÑÊåá‰ª§„ÄÇ</p>
</li>
<li>
<p><code>kubelet</code>ÔºöÂú®ÈõÜÁæ§‰∏≠ÁöÑÊØè‰∏™ËäÇÁÇπ‰∏äÁî®Êù•ÂêØÂä® pod ÂíåÂÆπÂô®Á≠â„ÄÇ</p>
</li>
<li>
<p><code>kubectl</code>ÔºöÁî®Êù•‰∏éÈõÜÁæ§ÈÄö‰ø°ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºàWorker ËäÇÁÇπÂèØ‰ª•‰∏çË£ÖÔºå‰ΩÜÊòØÊàëË£Ö‰∫ÜÔºå‰∏çÂΩ±Âìç‰ªÄ‰πàÔºâ„ÄÇ</p>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÈÖçÁΩÆK8SÁöÑyumÊ∫ê</span>
<span style="color:#75715e"># ËøôÈÉ®ÂàÜÁî®ÊòØÈòøÈáå‰∫ëÁöÑÊ∫êÔºåÂ¶ÇÊûúÂèØ‰ª•ËÆøÈóÆGoogleÔºåÂàôÂª∫ËÆÆÁî®ÂÆòÊñπÁöÑÊ∫ê</span>
cat <span style="color:#e6db74">&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style="color:#e6db74">[kubernetes]
</span><span style="color:#e6db74">name=Kubernetes
</span><span style="color:#e6db74">baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64
</span><span style="color:#e6db74">enabled=1
</span><span style="color:#e6db74">gpgcheck=1
</span><span style="color:#e6db74">repo_gpgcheck=1
</span><span style="color:#e6db74">gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
</span><span style="color:#e6db74">EOF</span>

<span style="color:#75715e"># ÂÆòÊñπÊ∫êÈÖçÁΩÆÂ¶Ç‰∏ã</span>
cat <span style="color:#e6db74">&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style="color:#e6db74">[kubernetes]
</span><span style="color:#e6db74">name=Kubernetes
</span><span style="color:#e6db74">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
</span><span style="color:#e6db74">enabled=1
</span><span style="color:#e6db74">gpgcheck=1
</span><span style="color:#e6db74">repo_gpgcheck=1
</span><span style="color:#e6db74">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span><span style="color:#e6db74">EOF</span>
</code></pre></div><h2 id="32ÂºÄÂßãÂÆâË£Ö">3.2„ÄÅÂºÄÂßãÂÆâË£Ö</h2>
<p>ÂÆâË£ÖÊåáÂÆöÁâàÊú¨ <code>kubelet</code>„ÄÅ <code>kubeadm</code> „ÄÅ<code>kubectl</code>Ôºå ÊàëËøôÈáåÈÄâÊã©ÂΩìÂâçËæÉÊñ∞ÁöÑÁ®≥ÂÆöÁâà Kubernetes 1.17.3ÔºåÂ¶ÇÊûúÈÄâÊã©ÁöÑÁâàÊú¨‰∏ç‰∏ÄÊ†∑ÔºåÂú®ÊâßË°åÈõÜÁæ§ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºåÊ≥®ÊÑè <code>--kubernetes-version</code> ÁöÑÂÄº„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Â¢ûÂä†ÈÖçÁΩÆ</span>
cat <span style="color:#e6db74">&lt;&lt;EOF &gt; /etc/sysctl.d/k8s.conf
</span><span style="color:#e6db74">net.ipv4.ip_forward=1
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-ip6tables = 1
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-iptables = 1
</span><span style="color:#e6db74">EOF</span>
<span style="color:#75715e"># Âä†ËΩΩ</span>
sysctl --system

<span style="color:#75715e"># ÂÆâË£Ö</span>
yum install -y kubelet-1.17.3 kubeadm-1.17.3 kubectl-1.17.3 --disableexcludes<span style="color:#f92672">=</span>kubernetes

<span style="color:#75715e"># ÂêØÂä®Âπ∂ËÆæÁΩÆ kubelet ÂºÄÊú∫ÂêØÂä®</span>
systemctl start kubelet
systemctl enable --now kubelet
</code></pre></div><blockquote>
<p>‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èWARNING</p>
<p>Â¶ÇÊûúÊ≠§Êó∂ÊâßË°å <code>systemctl status kubelet</code> ÂëΩ‰ª§ÔºåÁ≥ªÁªüÊó•ÂøóÂ∞ÜÂæóÂà∞ kubelet ÂêØÂä®Â§±Ë¥•ÁöÑÈîôËØØÊèêÁ§∫ÔºåËØ∑ÂøΩÁï•Ê≠§ÈîôËØØÔºåÂõ†‰∏∫ÂøÖÈ°ªÂÆåÊàêÂêéÁª≠Ê≠•È™§‰∏≠ kubeadm init ÁöÑÊìç‰ΩúÔºåkubelet ÊâçËÉΩÊ≠£Â∏∏ÂêØÂä®</p>
</blockquote>
<h1 id="Âõõ‰ΩøÁî®-kubeadm-ÂàõÂª∫ÈõÜÁæ§">Âõõ„ÄÅ‰ΩøÁî® Kubeadm ÂàõÂª∫ÈõÜÁæ§</h1>
<h2 id="41ÂàùÂßãÂåñ-control-planemaster-ËäÇÁÇπ">4.1„ÄÅÂàùÂßãÂåñ Control-plane/Master ËäÇÁÇπ</h2>
<p>Âú®Á¨¨‰∏ÄÂè∞ Master ‰∏äÊâßË°åÂàùÂßãÂåñÔºåÊâßË°åÂàùÂßãÂåñ‰ΩøÁî® <code>kubeadm init</code> ÂëΩ‰ª§„ÄÇÂàùÂßãÂåñÈ¶ñÂÖà‰ºöÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑËøêË°åÂâçÊ£ÄÊü•Êù•Á°Æ‰øùÊú∫Âô®Êª°Ë∂≥ËøêË°å Kubernetes ÁöÑÊù°‰ª∂ÔºåËøô‰∫õÊ£ÄÊü•‰ºöÊäõÂá∫Ë≠¶ÂëäÂπ∂Âú®ÂèëÁé∞ÈîôËØØÁöÑÊó∂ÂÄôÁªàÊ≠¢Êï¥‰∏™ÂàùÂßãÂåñËøõÁ®ã„ÄÇ ÁÑ∂Âêé <code>kubeadm init</code> ‰ºö‰∏ãËΩΩÂπ∂ÂÆâË£ÖÈõÜÁæ§ÁöÑ Control-plane ÁªÑ‰ª∂„ÄÇ</p>
<p>Âú®ÂàùÂßãÂåñ‰πãÂâçÔºåÈúÄË¶ÅÂÖàËÆæÁΩÆ‰∏Ä‰∏ã hosts Ëß£ÊûêÔºå‰∏∫‰∫ÜÈÅøÂÖçÂèØËÉΩÂá∫Áé∞ÁöÑÈóÆÈ¢òÔºåÂêéÈù¢ÁöÑ Worker ËäÇÁÇπÊàë‰πüËøõË°å‰∫ÜÂêåÊ†∑ÁöÑÊìç‰Ωú„ÄÇÊ≥®ÊÑèÊåâÁÖß‰Ω†ÁöÑÂÆûÈôÖÊÉÖÂÜµ‰øÆÊîπMasterËäÇÁÇπÁöÑIPÔºåÂπ∂‰∏îÊ≥®ÊÑè <code>APISERVER_NAME</code> ÁöÑÂÄºÔºåÂ¶ÇÊûú‰Ω†Â∞ÜËøô‰∏™ apiserver ÂêçÁß∞ËÆæÁΩÆ‰∏∫Âà´ÁöÑÂÄºÔºå‰∏ãÈù¢ÂàùÂßãÂåñÊó∂ÂÄôÁöÑ <code>--control-plane-endpoint</code> ÁöÑÂÄº‰øùÊåÅ‰∏ÄËá¥„ÄÇ</p>
<blockquote>
<p>ÊèêÁ§∫Ôºö‰∏∫‰∫Ü‰Ωø Kubernetes ÈõÜÁæ§È´òÂèØÁî®ÔºåÂª∫ËÆÆÁªôÈõÜÁæ§ÁöÑÊéßÂà∂ËäÇÁÇπÈÖçÁΩÆË¥üËΩΩÂùáË°°Âô®ÔºåÂ¶Ç HAproxy + Keepalived Êàñ NginxÔºå‰∫ë‰∏äÂèØ‰ª•‰ΩøÁî®ÂÖ¨Êúâ‰∫ëÁöÑË¥üËΩΩÂùáË°°Âô®ÔºåÁÑ∂ÂêéÂú®‰ª•‰∏ãÈÉ®ÂàÜËÆæÁΩÆ <code>MASTER_IP</code> Âíå <code>APISERVER_NAME</code> ‰∏∫Ë¥üËΩΩÂùáË°°Âô®ÁöÑÂú∞ÂùÄÔºàIP:6443Ôºâ ÂíåÂüüÂêç„ÄÇ</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ËÆæÁΩÆhosts</span>
echo <span style="color:#e6db74">&#34;127.0.0.1 </span><span style="color:#66d9ef">$(</span>hostname<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> &gt;&gt; /etc/hosts
export MASTER_IP<span style="color:#f92672">=</span>192.168.115.49
export APISERVER_NAME<span style="color:#f92672">=</span>kuber4s.api
echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>MASTER_IP<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>APISERVER_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><blockquote>
<p>ÂèãÊÉÖÊèêÁ§∫üôÇüôÇüôÇÔºö</p>
<p>Êà™Ê≠¢2020Âπ¥01Êúà29Êó•ÔºåÂÆòÊñπÊñáÊ°£Â£∞Êòé‰∫Ü‰ΩøÁî® kubeadm ÂàùÂßãÂåñ master Êó∂Ôºå&ndash;config Ëøô‰∏™ÂèÇÊï∞ÊòØÂÆûÈ™åÊÄßË¥®ÁöÑÔºåÊâÄ‰ª•Â∞±‰∏çÁî®‰∫ÜÔºõÊàë‰ª¨Áî®ÂÖ∂‰ªñÂèÇÊï∞‰∏ÄÊ†∑ÂèØ‰ª•ÂÆåÊàê master ÁöÑÂàùÂßãÂåñ„ÄÇ</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--config string   kubeadm ÈÖçÁΩÆÊñá‰ª∂„ÄÇ Ë≠¶ÂëäÔºöÈÖçÁΩÆÊñá‰ª∂ÁöÑ‰ΩøÁî®ÊòØËØïÈ™åÊÄßÁöÑ„ÄÇ
</code></pre></div><p>‰∏ãÈù¢Êúâ‰∏çÂ∏¶Ê≥®ÈáäÁöÑÂàùÂßãÂåñÂëΩ‰ª§ÔºåÂª∫ËÆÆÂÖàÊü•ÁúãÂ∏¶Ê≥®ÈáäÁöÑÊØè‰∏™ÂèÇÊï∞ÂØπÂ∫îÁöÑÊÑè‰πâÔºåÁ°Æ‰øù‰∏é‰Ω†ÁöÑÂΩìÂâçÈÖçÁΩÆÁöÑÁéØÂ¢ÉÊòØ‰∏ÄËá¥ÁöÑÔºåÁÑ∂ÂêéÂÜçÊâßË°åÂàùÂßãÂåñÊìç‰ΩúÔºåÈÅøÂÖçË∏©Èõ∑„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÂàùÂßãÂåñ Control-plane/Master ËäÇÁÇπ</span>
kubeadm init <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --apiserver-advertise-address 0.0.0.0 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># API ÊúçÂä°Âô®ÊâÄÂÖ¨Â∏ÉÁöÑÂÖ∂Ê≠£Âú®ÁõëÂê¨ÁöÑ IP Âú∞ÂùÄ,ÊåáÂÆö‚Äú0.0.0.0‚Äù‰ª•‰ΩøÁî®ÈªòËÆ§ÁΩëÁªúÊé•Âè£ÁöÑÂú∞ÂùÄ</span>
    <span style="color:#75715e"># ÂàáËÆ∞Âè™ÂèØ‰ª•ÊòØÂÜÖÁΩëIPÔºå‰∏çËÉΩÊòØÂ§ñÁΩëIPÔºåÂ¶ÇÊûúÊúâÂ§öÁΩëÂç°ÔºåÂèØ‰ª•‰ΩøÁî®Ê≠§ÈÄâÈ°πÊåáÂÆöÊüê‰∏™ÁΩëÂç°</span>
    --apiserver-bind-port <span style="color:#ae81ff">6443</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># API ÊúçÂä°Âô®ÁªëÂÆöÁöÑÁ´ØÂè£,ÈªòËÆ§ 6443</span>
    --cert-dir /etc/kubernetes/pki <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ‰øùÂ≠òÂíåÂ≠òÂÇ®ËØÅ‰π¶ÁöÑË∑ØÂæÑÔºåÈªòËÆ§ÂÄºÔºö&#34;/etc/kubernetes/pki&#34;</span>
    --control-plane-endpoint kuber4s.api <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ‰∏∫ÊéßÂà∂Âπ≥Èù¢ÊåáÂÆö‰∏Ä‰∏™Á®≥ÂÆöÁöÑ IP Âú∞ÂùÄÊàñ DNS ÂêçÁß∞,</span>
    <span style="color:#75715e"># ËøôÈáåÊåáÂÆöÁöÑ kuber4s.api Â∑≤ÁªèÂú® /etc/hosts ÈÖçÁΩÆËß£Êûê‰∏∫Êú¨Êú∫IP</span>
    --image-repository registry.cn-hangzhou.aliyuncs.com/google_containers <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ÈÄâÊã©Áî®‰∫éÊãâÂèñControl-planeÁöÑÈïúÂÉèÁöÑÂÆπÂô®‰ªìÂ∫ìÔºåÈªòËÆ§ÂÄºÔºö&#34;k8s.gcr.io&#34;</span>
    <span style="color:#75715e"># Âõ† GoogleË¢´Â¢ôÔºåËøôÈáåÈÄâÊã©ÂõΩÂÜÖ‰ªìÂ∫ì</span>
    --kubernetes-version 1.17.3 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ‰∏∫Control-planeÈÄâÊã©‰∏Ä‰∏™ÁâπÂÆöÁöÑ Kubernetes ÁâàÊú¨Ôºå ÈªòËÆ§ÂÄºÔºö&#34;stable-1&#34;</span>
    --node-name master01 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e">#  ÊåáÂÆöËäÇÁÇπÁöÑÂêçÁß∞,‰∏çÊåáÂÆöÁöÑËØù‰∏∫‰∏ªÊú∫hostnameÔºåÈªòËÆ§ÂèØ‰ª•‰∏çÊåáÂÆö</span>
    --pod-network-cidr 10.10.0.0/16 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ÊåáÂÆöpodÁöÑIPÂú∞ÂùÄËåÉÂõ¥</span>
    --service-cidr 10.20.0.0/16 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ÊåáÂÆöServiceÁöÑVIPÂú∞ÂùÄËåÉÂõ¥</span>
    --service-dns-domain cluster.local <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#75715e"># ‰∏∫ServiceÂè¶Â§ñÊåáÂÆöÂüüÂêçÔºåÈªòËÆ§&#34;cluster.local&#34;</span>
    --upload-certs
    <span style="color:#75715e"># Â∞Ü Control-plane ËØÅ‰π¶‰∏ä‰º†Âà∞ kubeadm-certs Secret</span>
</code></pre></div><p>‰∏çÂ∏¶Ê≥®ÈáäÁöÑÂÜÖÂÆπÂ¶Ç‰∏ãÔºåÂ¶ÇÊûúÂàùÂßãÂåñË∂ÖÊó∂ÔºåÂèØ‰ª•‰øÆÊîπDNS‰∏∫8.8.8.8ÂêéÈáçÂêØÁΩëÁªúÊúçÂä°ÂÜçÊ¨°Â∞ùËØï„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm init <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --apiserver-advertise-address 0.0.0.0 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --apiserver-bind-port <span style="color:#ae81ff">6443</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --cert-dir /etc/kubernetes/pki <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --control-plane-endpoint kuber4s.api <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --image-repository registry.cn-hangzhou.aliyuncs.com/google_containers <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --kubernetes-version 1.17.3 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --pod-network-cidr 10.10.0.0/16 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --service-cidr 10.20.0.0/16 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --service-dns-domain cluster.local <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --upload-certs
</code></pre></div><p>Êé•‰∏ãÊù•Ëøô‰∏™ËøáÁ®ãÊúâÁÇπÊº´ÈïøÔºàÂàùÂßãÂåñ‰ºö‰∏ãËΩΩÈïúÂÉè„ÄÅÂàõÂª∫ÈÖçÁΩÆÊñá‰ª∂„ÄÅÂêØÂä®ÂÆπÂô®Á≠âÊìç‰ΩúÔºâÔºåÊ≥°ÊùØËå∂ÔºåËÄêÂøÉÁ≠âÂæÖÔºå‰Ω†‰πüÂèØ‰ª•ÊâßË°å <code>tailf /var/log/messages</code> Êù•ÂÆûÊó∂Êü•ÁúãÁ≥ªÁªüÊó•ÂøóÔºåËßÇÂØü Master ÁöÑÂàùÂßãÂåñËøõÂ±ïÔºåÊúüÈó¥Á¢∞Âà∞‰∏Ä‰∫õÊä•Èîô‰∏çË¶ÅÁ¥ßÂº†ÔºåÂèØËÉΩÂè™ÊòØÊöÇÊó∂ÁöÑÈîôËØØÔºåÁ≠âÂæÖÊúÄÁªàÂèçÈ¶àÁöÑÁªìÊûúÂç≥ÂèØ„ÄÇ</p>
<p>Â¶ÇÊûúÂàùÂßãÂåñÊúÄÁªàÊàêÂäüÊâßË°åÔºå‰Ω†Â∞ÜÁúãÂà∞Â¶Ç‰∏ã‰ø°ÊÅØÔºö</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Your Kubernetes control-plane has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown <span style="color:#66d9ef">$(</span>id -u<span style="color:#66d9ef">)</span>:<span style="color:#66d9ef">$(</span>id -g<span style="color:#66d9ef">)</span> $HOME/.kube/config

You should now deploy a pod network to the cluster.
Run <span style="color:#e6db74">&#34;kubectl apply -f [podnetwork].yaml&#34;</span> with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

You can now join any number of the control-plane node running the following command on each as root:

  kubeadm join kuber4s.api:6443 --token 0j287q.jw9zfjxud8w85tis <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --control-plane --certificate-key 528b0b9f2861f8f02dfd4a59fc54ad21e42a7dea4dc5552ac24d9c650c5d4d80

Please note that the certificate-key gives access to cluster sensitive data, keep it secret!
As a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use
<span style="color:#e6db74">&#34;kubeadm init phase upload-certs --upload-certs&#34;</span> to reload certs afterward.

Then you can join any number of worker nodes by running the following on each as root:

kubeadm join kuber4s.api:6443 --token 0j287q.jw9zfjxud8w85tis <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f
</code></pre></div><p>‰∏∫ÊôÆÈÄöÁî®Êà∑Ê∑ªÂä† <code>kubectl</code> ËøêË°åÊùÉÈôêÔºåÂëΩ‰ª§ÂÜÖÂÆπÂú®ÂàùÂßãÂåñÊàêÂäüÂêéÁöÑËæìÂá∫ÂÜÖÂÆπ‰∏≠ÂèØ‰ª•ÁúãÂà∞„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown <span style="color:#66d9ef">$(</span>id -u<span style="color:#66d9ef">)</span>:<span style="color:#66d9ef">$(</span>id -g<span style="color:#66d9ef">)</span> $HOME/.kube/config
</code></pre></div><p>Âª∫ËÆÆrootÁî®Êà∑‰πüËøõË°å‰ª•‰∏äÊìç‰ΩúÔºå‰ΩúËÄÖ‰ΩøÁî®ÁöÑÊòØrootÁî®Êà∑ÊâßË°åÁöÑÂàùÂßãÂåñÊìç‰ΩúÔºåÁÑ∂ÂêéÂú®Êìç‰ΩúÂÆåÊàêÂêéÊü•ÁúãÈõÜÁæ§Áä∂ÊÄÅÁöÑÊó∂ÂÄôÔºåÂá∫Áé∞Â¶Ç‰∏ãÈîôËØØÔºö</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">The connection to the server localhost:8080 was refused - did you specify the right host or port?
</code></pre></div><p>ËøôÊó∂ÂÄôËØ∑Â§á‰ªΩÂ•Ω <code>kubeadm init</code> ËæìÂá∫‰∏≠ÁöÑ <code>kubeadm join</code> ÂëΩ‰ª§ÔºåÂõ†‰∏∫Â∞Ü‰ºöÈúÄË¶ÅËøô‰∏™ÂëΩ‰ª§Êù•ÁªôÈõÜÁæ§Ê∑ªÂä†ËäÇÁÇπ„ÄÇ</p>
<blockquote>
<p>‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èÊèêÁ§∫Ôºö‰ª§ÁâåÊòØ‰∏ªËäÇÁÇπÂíåÊñ∞Ê∑ªÂä†ÁöÑËäÇÁÇπ‰πãÈó¥ËøõË°åÁõ∏‰∫íË∫´‰ªΩÈ™åËØÅÁöÑÔºåÂõ†Ê≠§ËØ∑Á°Æ‰øùÂÖ∂ÂÆâÂÖ®„ÄÇ‰ªª‰Ωï‰∫∫Âè™Ë¶ÅÁü•ÈÅì‰∫ÜËøô‰∫õ‰ª§ÁâåÔºåÂ∞±ÂèØ‰ª•Èöè‰æøÁªôÊÇ®ÁöÑÈõÜÁæ§Ê∑ªÂä†ËäÇÁÇπ„ÄÇ ‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>kubeadm token</code> ÂëΩ‰ª§Êù•Êü•Áúã„ÄÅÂàõÂª∫ÂíåÂà†Èô§ËøôÁ±ª‰ª§Áâå„ÄÇ</p>
</blockquote>
<h2 id="42ÂÆâË£Ö-pod-ÁΩëÁªúÈôÑÂä†ÁªÑ‰ª∂">4.2„ÄÅÂÆâË£Ö Pod ÁΩëÁªúÈôÑÂä†ÁªÑ‰ª∂</h2>
<p>ÂÖ≥‰∫é Kubernetes ÁΩëÁªúÔºåÂª∫ËÆÆËØªÂÆåËøôÁØá <a href="https://yuerblog.cc/2019/02/25/flannel-and-calico/" target="_blank" rel="noopener noreferrer">ÊñáÁ´†</a>Ôºå‰ª•ÂèäÊñáÊú´ÁöÑÂÖ∂‰ªñÈìæÊé•ÔºåÂ¶Ç<a href="https://juejin.im/entry/599d33ad6fb9a0247804d430" target="_blank" rel="noopener noreferrer">Ëøô‰∏™</a>„ÄÇ</p>
<p>ÈõÜÁæ§ÂøÖÈ°ªÂÆâË£ÖPodÁΩëÁªúÊèí‰ª∂Ôºå‰ª•‰ΩøPodÂèØ‰ª•Áõ∏‰∫íÈÄö‰ø°ÔºåÂè™ÈúÄË¶ÅÂú®MasterËäÇÁÇπÊìç‰ΩúÔºåÂÖ∂‰ªñÊñ∞Âä†ÂÖ•ÁöÑËäÇÁÇπ‰ºöËá™Âä®ÂàõÂª∫Áõ∏ÂÖ≥pod„ÄÇ</p>
<p>ÂøÖÈ°ªÂú®‰ªª‰ΩïÂ∫îÁî®Á®ãÂ∫è‰πãÂâçÈÉ®ÁΩ≤ÁΩëÁªúÁªÑ‰ª∂„ÄÇÂè¶Â§ñÔºåÂú®ÂÆâË£ÖÁΩëÁªú‰πãÂâçÔºåCoreDNSÂ∞Ü‰∏ç‰ºöÂêØÂä®Ôºà‰Ω†ÂèØ‰ª•ÈÄöËøáÂëΩ‰ª§ <code>kubectl get pods --all-namespaces|grep coredns</code> Êü•Áúã CoreDNS ÁöÑÁä∂ÊÄÅÔºâ„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Êü•Áúã CoreDNS ÁöÑÁä∂ÊÄÅ,Âπ∂‰∏çÊòØ Running Áä∂ÊÄÅ</span>
$ kubectl get pods --all-namespaces|grep coredns
kube-system   coredns-7f9c544f75-bzksd    0/1   Pending   <span style="color:#ae81ff">0</span>     14m
kube-system   coredns-7f9c544f75-mtrwq    0/1   Pending   <span style="color:#ae81ff">0</span>     14m
</code></pre></div><p>kubeadm ÊîØÊåÅÂ§öÁßçÁΩëÁªúÊèí‰ª∂ÔºåÊàë‰ª¨ÈÄâÊã© Calico ÁΩëÁªúÊèí‰ª∂Ôºàkubeadm ‰ªÖÊîØÊåÅÂü∫‰∫éÂÆπÂô®ÁΩëÁªúÊé•Âè£ÔºàCNIÔºâÁöÑÁΩëÁªúÔºà‰∏çÊîØÊåÅkubenetÔºâ„ÄÇÔºâÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂÆÉÁªôÂá∫ÁöÑpodÁöÑIPÊÆµÂú∞ÂùÄÊòØ <code>192.168.0.0/16</code> ,Â¶ÇÊûú‰Ω†ÁöÑÊú∫Âô®Â∑≤Áªè‰ΩøÁî®‰∫ÜÊ≠§IPÊÆµÔºåÂ∞±ÈúÄË¶Å‰øÆÊîπËøô‰∏™ÈÖçÁΩÆÈ°πÔºåÂ∞ÜÂÖ∂ÂÄºÊîπ‰∏∫Âú®ÂàùÂßãÂåñ Master ËäÇÁÇπÊó∂‰ΩøÁî® <code>kubeadm init --pod-network-cidr=x.x.x.x/x</code> ÁöÑIPÂú∞ÂùÄÊÆµÔºåÂç≥Êàë‰ª¨‰∏äÈù¢ÈÖçÁΩÆÁöÑ <code>10.10.0.0/16</code> ÔºåÂ§ßÊ¶ÇÂú®625Ë°åÂ∑¶Âè≥ÔºåÊìç‰ΩúÂ¶Ç‰∏ã:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂</span>
mkdir calico <span style="color:#f92672">&amp;&amp;</span> cd calico
wget https://docs.projectcalico.org/v3.8/manifests/calico.yaml

<span style="color:#75715e"># ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂</span>
<span style="color:#75715e"># ÊâæÂà∞ 625 Ë°åÂ∑¶Âè≥ÁöÑ 192.168.0.0/16 ÔºåÂπ∂‰øÆÊîπ‰∏∫Êàë‰ª¨ÂàùÂßãÂåñÊó∂ÈÖçÁΩÆÁöÑ 10.10.0.0/16</span>
vim calico.yaml

<span style="color:#75715e"># ÈÉ®ÁΩ≤ Pod ÁΩëÁªúÁªÑ‰ª∂</span>
kubectl apply -f calico.yaml
</code></pre></div><p>Á®çÁ≠âÁâáÂàªÊü•ËØ¢ pod ËØ¶ÊÉÖÔºå‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® <code>watch</code> ÂëΩ‰ª§Êù•ÂÆûÊó∂Êü•Áúã pod ÁöÑÁä∂ÊÄÅÔºåÁ≠âÂæÖ Pod ÁΩëÁªúÁªÑ‰ª∂ÈÉ®ÁΩ≤ÊàêÂäüÂêéÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∫õ‰ø°ÊÅØ‰∫ÜÔºåÂåÖÊã¨ Pod ÁöÑ IP Âú∞ÂùÄ‰ø°ÊÅØÔºåËøô‰∏™ËøáÁ®ãÊó∂Èó¥ÂèØËÉΩ‰ºöÊúâÁÇπÈïø„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">watch -n <span style="color:#ae81ff">2</span> kubectl get pods --all-namespaces -o wide
</code></pre></div><h2 id="43Â∞Ü-worker-ËäÇÁÇπÊ∑ªÂä†Âà∞-kubernetes">4.3„ÄÅÂ∞Ü Worker ËäÇÁÇπÊ∑ªÂä†Âà∞ Kubernetes</h2>
<p>ËØ∑È¶ñÂÖàÁ°ÆËÆ§ Worker ËäÇÁÇπÊª°Ë∂≥Á¨¨‰∏ÄÈÉ®ÂàÜÁöÑÁéØÂ¢ÉËØ¥ÊòéÔºåÂπ∂‰∏îÂ∑≤ÁªèÂÆâË£Ö‰∫Ü Docker Âíå kubeadm„ÄÅkubelet „ÄÅkubectlÔºåÂπ∂‰∏îÂ∑≤ÁªèÂêØÂä® kubelet„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ê∑ªÂä† Hosts Ëß£Êûê</span>
echo <span style="color:#e6db74">&#34;127.0.0.1 </span><span style="color:#66d9ef">$(</span>hostname<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> &gt;&gt; /etc/hosts
export MASTER_IP<span style="color:#f92672">=</span>192.168.115.49
export APISERVER_NAME<span style="color:#f92672">=</span>kuber4s.api
echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>MASTER_IP<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>APISERVER_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><p>Â∞Ü Worker ËäÇÁÇπÊ∑ªÂä†Âà∞ÈõÜÁæ§ÔºåËøôÈáåÊ≥®ÊÑèÔºåÊâßË°åÂêéÂèØËÉΩ‰ºöÊä•ÈîôÔºåÊúâÂπ∏ÁöÑËØù‰Ω†‰ºöË∑≥ËøõËøô‰∏™ÂùëÔºåËøôÊòØÂõ†‰∏∫ Worker ËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§ÁöÑÂëΩ‰ª§ÂÆûÈôÖ‰∏äÂú®ÂàùÂßãÂåñ master Êó∂Â∑≤ÁªèÊúâÊèêÁ§∫Âá∫Êù•‰∫ÜÔºå‰∏çËøá‰∏§Â∞èÊó∂Âêé‰ºöÂà†Èô§‰∏ä‰º†ÁöÑËØÅ‰π¶ÔºåÊâÄ‰ª•Â¶ÇÊûú‰Ω†Ê≠§Êó∂Âä†ÂÖ•ÈõÜÁæ§ÁöÑÊó∂ÂÄôÊèêÁ§∫ËØÅ‰π¶Áõ∏ÂÖ≥ÁöÑÈîôËØØÔºåËØ∑ÊâßË°å <code>kubeadm init phase upload-certs --upload-certs</code>  ÈáçÊñ∞Âä†ËΩΩËØÅ‰π¶„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm join kuber4s.api:6443 --token 0y1dj2.ih27ainxwyib0911 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --discovery-token-ca-cert-hash sha256:5204b3e358a0d568e147908cba8036bdb63e604d4f4c1c3730398f33144fac61 <span style="color:#ae81ff">\
</span></code></pre></div><p>ÊâßË°åÂä†ÂÖ•Êìç‰ΩúÔºå‰Ω†ÂèØËÉΩ‰ºöÂèëÁé∞Âç°ÁùÄ‰∏çÂä®ÔºåÂ§ßÊ¶ÇÁéáÊòØÂõ†‰∏∫‰ª§ÁâåIDÂØπÊ≠§ÈõÜÁæ§Êó†ÊïàÊàñÂ∑≤Ëøá 2 Â∞èÊó∂ÁöÑÊúâÊïàÊúüÔºàÈÄöËøáÊâßË°å <code>kubeadm join --v=5</code> Êù•Ëé∑ÂèñËØ¶ÁªÜÁöÑÂä†ÂÖ•ËøáÁ®ãÔºåÁúãÂà∞‰∫ÜÂÜÖÂÆπ‰∏∫ ‚Äùtoken id &ldquo;0y1dj2&rdquo; is invalid for this cluster or it has expired‚Äú ÁöÑÊèêÁ§∫ÔºâÔºåÊé•‰∏ãÊù•ÈúÄË¶ÅÂú® Master ‰∏äÈÄöËøá <code>kubeadm token create</code> Êù•ÂàõÂª∫Êñ∞ÁöÑ‰ª§Áâå„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubeadm token create --print-join-command
W0129 19:10:04.842735   <span style="color:#ae81ff">15533</span> validation.go:28<span style="color:#f92672">]</span> Cannot validate kube-proxy config - no validator is available
W0129 19:10:04.842808   <span style="color:#ae81ff">15533</span> validation.go:28<span style="color:#f92672">]</span> Cannot validate kubelet config - no validator is available
<span style="color:#75715e"># ËæìÂá∫ÁªìÊûúÂ¶Ç‰∏ã</span>
kubeadm join kuber4s.api:6443 --token 1hk9bc.oz7f3lmtbzf15x9b     --discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f
</code></pre></div><p>Âú® Worker ËäÇÁÇπ‰∏äÈáçÊñ∞ÊâßË°åÂä†ÂÖ•ÈõÜÁæ§ÂëΩ‰ª§</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm join kuber4s.api:6443 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --token 1hk9bc.oz7f3lmtbzf15x9b <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f
</code></pre></div><p>Êé•‰∏ãÊù•Âú®Master‰∏äÊü•Áúã Worker ËäÇÁÇπÂä†ÂÖ•ÁöÑÁä∂ÂÜµÔºåÁõ¥Âà∞ Worker ËäÇÁÇπÁöÑÁä∂ÊÄÅÂèò‰∏∫ Ready ‰æøËØÅÊòéÂä†ÂÖ•ÊàêÂäüÔºåËøô‰∏™ËøáÁ®ãÂèØËÉΩ‰ºöÊúâÁÇπÊº´ÈïøÔºå30 ÂàÜÈíü‰ª•ÂÜÖÈÉΩÁÆóÊ≠£Â∏∏ÁöÑÔºå‰∏ªË¶ÅÁúã‰Ω†ÁΩëÁªúÁöÑÊÉÖÂÜµÊàñËÄÖËØ¥ÊãâÂèñÈïúÂÉèÁöÑÈÄüÂ∫¶ÔºõÂè¶Â§ñ‰∏çË¶Å‰∏ÄÁúãÂà∞ <code>/var/log/messages</code> ÈáåÈù¢Êä•ÈîôÂ∞±ÊÖå‰∫ÜÔºåÈÇ£‰πüÂæóÁúãÂÖ∑‰ΩìÊä•‰ªÄ‰πàÈîôÔºåÁúã‰∏çÊáÇÂ∞±Á®çÂæÆÁ≠â‰∏Ä‰∏ãÔºå‰∏ÄËà¨Âú® Master ‰∏äËÉΩÁúãÂà∞Â∑≤ÁªèÂä†ÂÖ•ÔºàËôΩÁÑ∂Ê≤°ÊúâReadyÔºâÂ∞±Ê≤°‰ªÄ‰πàÈóÆÈ¢ò„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">watch kubectl get nodes -o wide
</code></pre></div><h2 id="44Ê∑ªÂä†-master-ËäÇÁÇπ">4.4„ÄÅÊ∑ªÂä† Master ËäÇÁÇπ</h2>
<p>ÈúÄË¶ÅËá≥Â∞ë2‰∏™CPUÊ†∏ÂøÉÔºåÂê¶Âàô‰ºöÊä•Èîô</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm join kuber4s.api:6443 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --token 1hk9bc.oz7f3lmtbzf15x9b <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --control-plane --certificate-key 5253fc7e9a4e6204d0683ed2d60db336b3ff64ddad30ba59b4c0bf40d8ccadcd
</code></pre></div><h2 id="45Ë°•ÂÖÖÂÜÖÂÆπ">4.5„ÄÅË°•ÂÖÖÂÜÖÂÆπ</h2>
<ul>
<li><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/" target="_blank" rel="noopener noreferrer">kubeadm init</a> ÂàùÂßãÂåñ Kubernetes ‰∏ªËäÇÁÇπ</li>
<li><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-token/" target="_blank" rel="noopener noreferrer">kubeadm token</a> ÁÆ°ÁêÜ <code>kubeadm join</code> ÁöÑ‰ª§Áâå</li>
<li><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-reset/" target="_blank" rel="noopener noreferrer">kubeadm reset</a> Â∞Ü <code>kubeadm init</code> Êàñ <code>kubeadm join</code> ÂØπ‰∏ªÊú∫ÁöÑÊõ¥ÊîπÊÅ¢Â§çÂà∞‰πãÂâçÁä∂ÊÄÅÔºå‰∏ÄËà¨‰∏é <code>-f</code> ÂèÇÊï∞‰ΩøÁî®</li>
</ul>
<p>ÁßªÈô§ worker ËäÇÁÇπ</p>
<p>Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºå‰Ω†Êó†ÈúÄÁßªÈô§ worker ËäÇÁÇπÔºåÂ¶ÇÊûúË¶ÅÁßªÈô§ÔºåÂú®ÂáÜÂ§áÁßªÈô§ÁöÑ worker ËäÇÁÇπ‰∏äÊâßË°å</p>
<pre><code>kubeadm reset -f
</code></pre><p>ÊàñËÄÖÂú® Control-plane ‰∏äÊâßË°å</p>
<pre><code>kubectl delete node nodename
</code></pre><blockquote>
<ul>
<li>Â∞Ü nodename ÊõøÊç¢‰∏∫Ë¶ÅÁßªÈô§ÁöÑ worker ËäÇÁÇπÁöÑÂêçÂ≠ó</li>
<li>worker ËäÇÁÇπÁöÑÂêçÂ≠óÂèØ‰ª•ÈÄöËøáÂú® Control-plane ‰∏äÊâßË°å kubectl get nodes ÂëΩ‰ª§Ëé∑Âæó</li>
</ul>
</blockquote>
<h1 id="‰∫îkubernetes-È´òÂèØÁî®ÈõÜÁæ§">‰∫î„ÄÅKubernetes È´òÂèØÁî®ÈõÜÁæ§</h1>
<h2 id="51ÁéØÂ¢ÉËØ¥Êòé">5.1„ÄÅÁéØÂ¢ÉËØ¥Êòé</h2>
<p>Â¶ÇÊûú‰Ω†‰ΩøÁî®ÁöÑÊòØ‰ª•‰∏äÊñπÊ≥ïÈÉ®ÁΩ≤‰Ω†ÁöÑ Kubernetes ÈõÜÁæ§ÔºåÊÉ≥Âú®ÂΩìÂâçÂü∫Á°Ä‰∏äËøõË°åÈ´òÂèØÁî®ÈõÜÁæ§ÁöÑÂàõÂª∫ÔºåÂàôÂèØ‰ª•ÊåâÁÖß‰∏ãÈù¢ÁöÑÊ≠•È™§ÁªßÁª≠ËøõË°å„ÄÇ</p>
<p>ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåËøôÈáåÊ≤°ÊúâÂ∞ÜETCDÊîæÂú®MasterÂ§ñÁöÑÊú∫Âô®‰∏äÔºåËÄåÊòØ‰ΩøÁî®ÈªòËÆ§ÁöÑÊû∂ÊûÑÔºåÂç≥ÂÆòÊñπÁöÑ Stacked etcd topology ÊñπÂºèÁöÑÈõÜÁæ§</p>
<p><img src="https://92uu-blog.oss-cn-beijing.aliyuncs.com/2020-03-25-091655.png" alt=""></p>
<p>‰Ω†ÈúÄË¶ÅËá≥Â∞ë 3 Âè∞ Master ËäÇÁÇπÂíå 3 Âè∞ Worker ËäÇÁÇπÔºåÊàñËÄÖÊõ¥Â§öÁöÑÊú∫Âô®Ôºå‰ΩÜË¶Å‰øùËØÅÊòØ Master Âíå Worker ËäÇÁÇπÊï∞ÈÉΩÊòØÂ•áÊï∞ÁöÑÔºå‰ª•Èò≤Ê≠¢ leader ÈÄâ‰∏æÊó∂Âá∫Áé∞ËÑëË£ÇÁä∂ÂÜµ„ÄÇ</p>
<table>
<thead>
<tr>
<th>Êú∫Âô®ÂêçÁß∞</th>
<th>Êú∫Âô®IP</th>
<th>Â∑•‰ΩúÂÜÖÂÆπ</th>
</tr>
</thead>
<tbody>
<tr>
<td>master01</td>
<td>192.168.115.49</td>
<td>master„ÄÅetcd</td>
</tr>
<tr>
<td>master02</td>
<td>192.168.115.41</td>
<td>master„ÄÅetcd</td>
</tr>
<tr>
<td>master03</td>
<td>192.168.115.42</td>
<td>master„ÄÅetcd</td>
</tr>
<tr>
<td>node01</td>
<td>192.168.115.46</td>
<td>worker</td>
</tr>
<tr>
<td>node02</td>
<td>192.168.115.47</td>
<td>worker</td>
</tr>
<tr>
<td>node03</td>
<td>192.168.115.48</td>
<td>worker</td>
</tr>
<tr>
<td>nfs</td>
<td>192.168.115.50</td>
<td>Â≠òÂÇ®</td>
</tr>
</tbody>
</table>
<h2 id="52È´òÂèØÁî®Êâ©Â±ï">5.2„ÄÅÈ´òÂèØÁî®Êâ©Â±ï</h2>
<p>Kubernetes ÁöÑÈ´òÂèØÁî®Êâ©Â±ïÂÖ∂ÂÆûÊå∫ÁÆÄÂçïÔºå‰Ω†Âè™ÈúÄË¶ÅÂ∞Ü‰∏çÂêåÁöÑ Master Âíå Worker ËäÇÁÇπÂä†ÂÖ•Âà∞ÈõÜÁæ§‰∏≠Â∞±Ë°å‰∫Ü„ÄÇÂä†ÂÖ•ÁöÑÊåá‰ª§Âú®‰Ω†ÂàùÂßãÂåñÈõÜÁæ§Êó∂Â∑≤ÁªèÁªôÂá∫‰∫Ü„ÄÇ</p>
<ul>
<li>Ê∑ªÂä† Master ËäÇÁÇπÔºö</li>
</ul>
<p>ÈúÄË¶ÅËá≥Â∞ë 2 ‰∏™ CPU Ê†∏ÂøÉÔºåÂê¶Âàô‰ºöÊä•Èîô</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm join kuber4s.api:6443 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --token 1hk9bc.oz7f3lmtbzf15x9b <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> --control-plane --certificate-key 5253fc7e9a4e6204d0683ed2d60db336b3ff64ddad30ba59b4c0bf40d8ccadcd
</code></pre></div><ul>
<li>Ê∑ªÂä† Worker ËäÇÁÇπ</li>
</ul>
<p>Âú® Worker ËäÇÁÇπ‰∏äÈáçÊñ∞ÊâßË°åÂä†ÂÖ•ÈõÜÁæ§ÂëΩ‰ª§</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm join kuber4s.api:6443 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--token 1hk9bc.oz7f3lmtbzf15x9b <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--discovery-token-ca-cert-hash sha256:5e8bcad5ec97c1025e8044f4b8fd0a4514ecda4bac2b3944f7f39ccae9e4921f
</code></pre></div><h1 id="ÂÖ≠ÂÆâË£Ö-kubesphere">ÂÖ≠„ÄÅÂÆâË£Ö KubeSphere</h1>
<h2 id="61kubesphereÁÆÄ‰ªã">6.1„ÄÅKubeSphereÁÆÄ‰ªã</h2>
<p>Kubernetes ÂÆòÊñπÊúâÊèê‰æõ‰∏ÄÂ•ó DashboardÔºå‰ΩÜÊòØÊàëËøôÈáåÈÄâÊã©ÂäüËÉΩÊõ¥Âº∫Â§ßÁöÑ KubeSphereÔºå‰ª•‰∏ãÂÜÖÂÆπÂºïÁî®Ëá™ KubeSphere ÂÆòÁΩëÔºö</p>
<p><a href="https://kubesphere.com.cn/docs/zh-CN/" target="_blank" rel="noopener noreferrer">KubeSphere</a> ÊòØÂú® <a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes</a> ‰πã‰∏äÊûÑÂª∫ÁöÑ‰ª•Â∫îÁî®‰∏∫‰∏≠ÂøÉÁöÑÂÆπÂô®Âπ≥Âè∞ÔºåÊèê‰æõÁÆÄÂçïÊòìÁî®ÁöÑÊìç‰ΩúÁïåÈù¢‰ª•ÂèäÂêëÂØºÂºèÊìç‰ΩúÊñπÂºèÔºåÂú®Èôç‰ΩéÁî®Êà∑‰ΩøÁî®ÂÆπÂô®Ë∞ÉÂ∫¶Âπ≥Âè∞Â≠¶‰π†ÊàêÊú¨ÁöÑÂêåÊó∂ÔºåÊûÅÂ§ßÂáèËΩªÂºÄÂèë„ÄÅÊµãËØï„ÄÅËøêÁª¥ÁöÑÊó•Â∏∏Â∑•‰ΩúÁöÑÂ§çÊùÇÂ∫¶ÔºåÊó®Âú®Ëß£ÂÜ≥ Kubernetes Êú¨Ë∫´Â≠òÂú®ÁöÑÂ≠òÂÇ®„ÄÅÁΩëÁªú„ÄÅÂÆâÂÖ®ÂíåÊòìÁî®ÊÄßÁ≠âÁóõÁÇπ„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÂπ≥Âè∞Â∑≤ÁªèÊï¥ÂêàÂπ∂‰ºòÂåñ‰∫ÜÂ§ö‰∏™ÈÄÇÁî®‰∫éÂÆπÂô®Âú∫ÊôØÁöÑÂäüËÉΩÊ®°ÂùóÔºå‰ª•ÂÆåÊï¥ÁöÑËß£ÂÜ≥ÊñπÊ°àÂ∏ÆÂä©‰ºÅ‰∏öËΩªÊùæÂ∫îÂØπÊïèÊç∑ÂºÄÂèë‰∏éËá™Âä®ÂåñËøêÁª¥„ÄÅDevOps„ÄÅÂæÆÊúçÂä°Ê≤ªÁêÜ„ÄÅÁÅ∞Â∫¶ÂèëÂ∏É„ÄÅÂ§öÁßüÊà∑ÁÆ°ÁêÜ„ÄÅÂ∑•‰ΩúË¥üËΩΩÂíåÈõÜÁæ§ÁÆ°ÁêÜ„ÄÅÁõëÊéßÂëäË≠¶„ÄÅÊó•ÂøóÊü•ËØ¢‰∏éÊî∂ÈõÜ„ÄÅÊúçÂä°‰∏éÁΩëÁªú„ÄÅÂ∫îÁî®ÂïÜÂ∫ó„ÄÅÈïúÂÉèÊûÑÂª∫‰∏éÈïúÂÉè‰ªìÂ∫ìÁÆ°ÁêÜÂíåÂ≠òÂÇ®ÁÆ°ÁêÜÁ≠âÂ§öÁßçÂú∫ÊôØ„ÄÇÂêéÁª≠ÁâàÊú¨Â∞ÜÊèê‰æõÂíåÊîØÊåÅÂ§öÈõÜÁæ§ÁÆ°ÁêÜ„ÄÅÂ§ßÊï∞ÊçÆ„ÄÅAI Á≠âÂú∫ÊôØ„ÄÇ</p>
<p><img src="https://pek3b.qingstor.com/kubesphere-docs/png/20200327114511.png" alt=""></p>
<h2 id="62ÂÆâË£ÖË¶ÅÊ±Ç">6.2„ÄÅÂÆâË£ÖË¶ÅÊ±Ç</h2>
<p>KubeSphere ÊîØÊåÅÁõ¥Êé•Âú® Linux ‰∏äÈÉ®ÁΩ≤ÈõÜÁæ§Ôºå‰πüÊîØÊåÅÂú® Kubernetes ‰∏äÈÉ®ÁΩ≤ÔºåÊàëËøôÈáåÈÄâÊã©ÂêéËÄÖÔºåÂü∫Êú¨ÁöÑË¶ÅÊ±ÇÂ¶Ç‰∏ãÔºö</p>
<ul>
<li><code>Kubernetes</code> ÁâàÊú¨Ôºö<code>1.15.x ‚â§ K8s version ‚â§ 1.17.x</code>Ôºõ</li>
<li><code>Helm</code> ÁâàÊú¨Ôºö<code>2.10.0 ‚â§ Helm Version Ôºú 3.0.0</code>Ôºà‰∏çÊîØÊåÅ helm 2.16.0<a href="https://github.com/helm/helm/issues/6894" target="_blank" rel="noopener noreferrer">#6894</a>ÔºâÔºå‰∏îÂ∑≤ÂÆâË£Ö‰∫Ü TillerÔºåÂèÇËÄÉ <a href="https://devopscube.com/install-configure-helm-kubernetes/" target="_blank" rel="noopener noreferrer">Â¶Ç‰ΩïÂÆâË£Ö‰∏éÈÖçÁΩÆ Helm</a>ÔºàÈ¢ÑËÆ° 3.0 ÊîØÊåÅ Helm v3ÔºâÔºõ</li>
<li>ÈõÜÁæ§Â∑≤ÊúâÈªòËÆ§ÁöÑÂ≠òÂÇ®Á±ªÂûãÔºàStorageClassÔºâÔºåËã•ËøòÊ≤°ÊúâÂáÜÂ§áÂ≠òÂÇ®ËØ∑ÂèÇËÄÉ<a href="https://kubesphere.com.cn/docs/zh-CN/appendix/install-openebs" target="_blank" rel="noopener noreferrer">ÂÆâË£Ö OpenEBS ÂàõÂª∫ LocalPV Â≠òÂÇ®Á±ªÂûã</a>Áî®‰ΩúÂºÄÂèëÊµãËØïÁéØÂ¢É„ÄÇ</li>
<li>ÈõÜÁæ§ËÉΩÂ§üËÆøÈóÆÂ§ñÁΩëÔºåËã•Êó†Â§ñÁΩëËØ∑ÂèÇËÄÉ <a href="https://kubesphere.com.cn/docs/installation/install-on-k8s-airgapped/" target="_blank" rel="noopener noreferrer">Âú® Kubernetes Á¶ªÁ∫øÂÆâË£Ö KubeSphere</a>„ÄÇ</li>
</ul>
<h2 id="63ÂÆâË£Ö-helm">6.3„ÄÅÂÆâË£Ö Helm</h2>
<h3 id="631helm-ÁÆÄ‰ªã">6.3.1„ÄÅHelm ÁÆÄ‰ªã</h3>
<p>Helm Âü∫Êú¨ÊÄùÊÉ≥Â¶ÇÂõæÊâÄÁ§∫</p>
<p><img src="https://92uu-blog.oss-cn-beijing.aliyuncs.com/2020-03-25-095440.png" alt=""></p>
<p>‰ª•‰∏ãÂÜÖÂÆπÂºïÁî®Ëá™ <a href="https://blog.csdn.net/weixin_30566063/article/details/99247145" target="_blank" rel="noopener noreferrer">Ê≠§ÁØáÊñáÁ´†</a></p>
<p><strong>Helm Âü∫Êú¨Ê¶ÇÂøµ</strong></p>
<p>Helm ÂèØ‰ª•ÁêÜËß£‰∏∫ Kubernetes ÁöÑÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÂèØ‰ª•Êñπ‰æøÂú∞ÂèëÁé∞„ÄÅÂÖ±‰∫´Âíå‰ΩøÁî®‰∏∫KubernetesÊûÑÂª∫ÁöÑÂ∫îÁî®ÔºåÂÆÉÂåÖÂê´Âá†‰∏™Âü∫Êú¨Ê¶ÇÂøµÔºö</p>
<ul>
<li>ChartÔºö‰∏Ä‰∏™ Helm ÂåÖÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫ÜËøêË°å‰∏Ä‰∏™Â∫îÁî®ÊâÄÈúÄË¶ÅÁöÑÈïúÂÉè„ÄÅ‰æùËµñÂíåËµÑÊ∫êÂÆö‰πâÁ≠âÔºåËøòÂèØËÉΩÂåÖÂê´ Kubernetes ÈõÜÁæ§‰∏≠ÁöÑÊúçÂä°ÂÆö‰πâ</li>
<li>Release: Âú® Kubernetes ÈõÜÁæ§‰∏äËøêË°åÁöÑ Chart ÁöÑ‰∏Ä‰∏™ÂÆû‰æã„ÄÇÂú®Âêå‰∏Ä‰∏™ÈõÜÁæ§‰∏äÔºå‰∏Ä‰∏™ Chart ÂèØ‰ª•ÂÆâË£ÖÂæàÂ§öÊ¨°„ÄÇÊØèÊ¨°ÂÆâË£ÖÈÉΩ‰ºöÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ release„ÄÇ‰æãÂ¶Ç‰∏Ä‰∏™ MySQL ChartÔºåÂ¶ÇÊûúÊÉ≥Âú®ÊúçÂä°Âô®‰∏äËøêË°å‰∏§‰∏™Êï∞ÊçÆÂ∫ìÔºåÂ∞±ÂèØ‰ª•ÊääËøô‰∏™ Chart ÂÆâË£Ö‰∏§Ê¨°„ÄÇÊØèÊ¨°ÂÆâË£ÖÈÉΩ‰ºöÁîüÊàêËá™Â∑±ÁöÑ ReleaseÔºå‰ºöÊúâËá™Â∑±ÁöÑ Release ÂêçÁß∞„ÄÇ</li>
<li>RepositoryÔºöÁî®‰∫éÂèëÂ∏ÉÂíåÂ≠òÂÇ® Chart ÁöÑ‰ªìÂ∫ì„ÄÇ</li>
</ul>
<h3 id="632helmÂÆâË£Ö">6.3.2„ÄÅHelmÂÆâË£Ö</h3>
<p>ÂÆâË£ÖËøáÁ®ãÂ¶Ç‰∏ã</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÂàõÂª∫ÈÉ®ÁΩ≤ÁõÆÂΩïÂπ∂‰∏ãËΩΩHelm</span>
mkdir tiller
cd tiller

<span style="color:#75715e"># ÂÖà‰ΩøÁî®ÂÆòÊñπÁöÑÊñπÂºèÂÆâË£ÖÔºåÂ¶ÇÊûúÂÆâË£Ö‰∏ç‰∫ÜÔºåÂèØ‰ª•ÁúãÂà∞‰∏ãËΩΩÊñá‰ª∂ÁöÑÂú∞ÂùÄÔºåÁÑ∂ÂêéÊâãÂä®‰∏ãËΩΩËß£Âéã</span>
curl -L https://git.io/get_helm.sh | bash
<span style="color:#75715e"># Ëé∑ÂèñÂà∞‰∏ãËΩΩÂú∞ÂùÄÂêéÔºåÊÉ≥ÂäûÊ≥ï‰∏ãËΩΩ</span>
wget https://get.helm.sh/helm-v2.16.3-linux-amd64.tar.gz
tar zxf helm-v2.16.3-linux-amd64.tar.gz
mv linux-amd64/helm /usr/local/bin/helm

<span style="color:#75715e"># È™åËØÅ</span>
helm version
</code></pre></div><p>ÈÉ®ÁΩ≤ TillerÔºåÂç≥ Helm ÁöÑÊúçÂä°Á´Ø„ÄÇÂÖàÂàõÂª∫ SA</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># yamlÊñá‰ª∂Â¶Ç‰∏ã</span>
$ cat /root/tiller/helm-rbac.yaml
<span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: ServiceAccount
<span style="color:#66d9ef">metadata</span>:
 <span style="color:#66d9ef">name</span>: tiller
 <span style="color:#66d9ef">namespace</span>: kube-system
---
<span style="color:#66d9ef">apiVersion</span>: rbac.authorization.k8s.io/v1
<span style="color:#66d9ef">kind</span>: ClusterRoleBinding
<span style="color:#66d9ef">metadata</span>:
 <span style="color:#66d9ef">name</span>: tiller
<span style="color:#66d9ef">roleRef</span>:
 <span style="color:#66d9ef">apiGroup</span>: rbac.authorization.k8s.io
 <span style="color:#66d9ef">kind</span>: ClusterRole
 <span style="color:#66d9ef">name</span>: cluster-admin
<span style="color:#66d9ef">subjects</span>:
 - <span style="color:#66d9ef">kind</span>: ServiceAccount
 <span style="color:#66d9ef">name</span>: tiller
 <span style="color:#66d9ef">namespace</span>: kube-system
</code></pre></div><p>ÂàõÂª∫ RBACÔºö</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f helm-rbac.yaml
</code></pre></div><p>ÂàùÂßãÂåñÔºåËøô‰∏™ËøáÁ®ãÂèØËÉΩ‰∏ç‰ºöÊàêÂäüÔºåÂÖ∑‰ΩìÊé•ÁùÄÂæÄ‰∏ãÁúã</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">helm init --service-account<span style="color:#f92672">=</span>tiller --history-max <span style="color:#ae81ff">300</span>
</code></pre></div><p>Ê£ÄÊü•ÂàùÂßãÂåñÁöÑÊÉÖÂÜµÔºå‰∏çÂá∫ÊÑèÂ§ñÁöÑËØùÔºåÂ¢ôÂÜÖÁî®Êà∑ÁúãpodËØ¶ÊÉÖÂèØ‰ª•ÁúãÂà∞Ëé∑Âèñ‰∏çÂà∞ÈïúÂÉèÁöÑÈîôËØØ„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get deployment tiller-deploy -n kube-system
</code></pre></div><p>Â¶ÇÊûú‰∏ÄÁõ¥Ëé∑Âèñ‰∏çÂà∞ÈïúÂÉèÔºåÂèØ‰ª•ÈÄöËøáÊõ¥Êç¢Âà∞Azure‰∏≠ÂõΩÈïúÂÉèÊ∫êÊù•Ëß£ÂÜ≥ÔºåÊìç‰ΩúÊ≠•È™§Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ÁºñËæë deploy</span>
kubectl edit deploy tiller-deploy -n kube-system
<span style="color:#75715e"># Êü•ÊâæÂà∞imageÂú∞ÂùÄÔºåÊõøÊç¢‰∏∫Â¶Ç‰∏ãÂú∞ÂùÄÔºå‰øùÂ≠òÈÄÄÂá∫</span>
gcr.azk8s.cn/kubernetes-helm/tiller:v2.16.3
</code></pre></div><p>Êé•‰∏ãÊù•Á®çÁ≠âÁâáÂàªÔºåÂÜçÊ¨°Êü•ÁúãdeploymentÂíåpodËØ¶ÊÉÖÔºåÂ∞±Ê≠£Â∏∏‰∫Ü</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get deployment tiller-deploy -n kube-system
</code></pre></div><h2 id="64ÂÆâË£Ö-storageclass">6.4„ÄÅÂÆâË£Ö StorageClass</h2>
<p>Kubernetes ÊîØÊåÅÂ§öÁßç StorageClassÔºåÊàëËøôÈÄâÊã© NFS ‰Ωú‰∏∫ÈõÜÁæ§ÁöÑ StorageClass„ÄÇ</p>
<p>ÂèÇËÄÉÂú∞ÂùÄÔºö<a href="https://github.com/kubernetes-incubator/external-storage/tree/master/nfs-client" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes-incubator/external-storage/tree/master/nfs-client</a></p>
<h3 id="641‰∏ãËΩΩÊâÄÈúÄÊñá‰ª∂">6.4.1„ÄÅ‰∏ãËΩΩÊâÄÈúÄÊñá‰ª∂</h3>
<p>‰∏ãËΩΩÊâÄÈúÄÊñá‰ª∂ÔºåÂπ∂ËøõË°åÂÜÖÂÆπË∞ÉÊï¥</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir nfsvolume <span style="color:#f92672">&amp;&amp;</span> cd nfsvolume
<span style="color:#66d9ef">for</span> file in class.yaml deployment.yaml rbac.yaml ; <span style="color:#66d9ef">do</span> wget https://raw.githubusercontent.com/kubernetes-incubator/external-storage/master/nfs-client/deploy/$file ; <span style="color:#66d9ef">done</span>
</code></pre></div><p>‰øÆÊîπ deployment.yaml ‰∏≠ÁöÑ‰∏§Â§Ñ NFS ÊúçÂä°Âô® IP ÂíåÁõÆÂΩï</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">...
          <span style="color:#66d9ef">env</span>:
            - <span style="color:#66d9ef">name</span>: PROVISIONER_NAME
              <span style="color:#66d9ef">value</span>: fuseim.pri/ifs
            - <span style="color:#66d9ef">name</span>: NFS_SERVER
              <span style="color:#66d9ef">value</span>: <span style="color:#ae81ff">192.168.115.50</span>
            - <span style="color:#66d9ef">name</span>: NFS_PATH
              <span style="color:#66d9ef">value</span>: /data/k8s
      <span style="color:#66d9ef">volumes</span>:
        - <span style="color:#66d9ef">name</span>: nfs-client-root
          <span style="color:#66d9ef">nfs</span>:
            <span style="color:#66d9ef">server</span>: <span style="color:#ae81ff">192.168.115.50</span>
            <span style="color:#66d9ef">path</span>: /data/k8s
</code></pre></div><h2 id="642ÈÉ®ÁΩ≤ÂàõÂª∫">6.4.2„ÄÅÈÉ®ÁΩ≤ÂàõÂª∫</h2>
<p>ÂÖ∑‰ΩìÁöÑËØ¥ÊòéÂèØ‰ª•ÂéªÂÆòÁΩëÊü•Áúã„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl create -f rbac.yaml
kubectl create -f class.yaml
kubectl create -f deployment.yaml
</code></pre></div><p>Â¶ÇÊûúÊó•Âøó‰∏≠ÁúãÂà∞‚Äú‰∏äÊúâÂùèË∂ÖÁ∫ßÂùó‚ÄùÔºåËØ∑Âú®ÈõÜÁæ§ÂÜÖÊâÄÊúâÊú∫Âô®‰∏äÂÆâË£Önfs-utilsÂπ∂ÂêØÂä®„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yum -y install nfs-utils
systemctl start nfs-utils
systemctl enable nfs-utils
rpcinfo -p
</code></pre></div><p>Êü•Áúãstorageclass</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get storageclass
NAME PROVISIONER RECLAIMPOLICY VOLUMEBINDINGMODE ALLOWVOLUMEEXPANSION AGE
managed-nfs-storage fuseim.pri/ifs Delete Immediate false 10m
</code></pre></div><h3 id="643Ê†áËÆ∞‰∏Ä‰∏™ÈªòËÆ§ÁöÑ-storageclass">6.4.3„ÄÅÊ†áËÆ∞‰∏Ä‰∏™ÈªòËÆ§ÁöÑ StorageClass</h3>
<p>Êìç‰ΩúÂëΩ‰ª§Ê†ºÂºèÂ¶Ç‰∏ã</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl patch storageclass  -p <span style="color:#e6db74">&#39;{&#34;metadata&#34;: {&#34;annotations&#34;:{&#34;storageclass.kubernetes.io/is-default-class&#34;:&#34;true&#34;}}}&#39;</span>
</code></pre></div><p>ËØ∑Ê≥®ÊÑèÔºåÊúÄÂ§öÂè™ËÉΩÊúâ‰∏Ä‰∏™ StorageClass ËÉΩÂ§üË¢´Ê†áËÆ∞‰∏∫ÈªòËÆ§„ÄÇ</p>
<p>È™åËØÅÊ†áËÆ∞ÊòØÂê¶ÊàêÂäü</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get storageclass
NAME PROVISIONER RECLAIMPOLICY VOLUMEBINDINGMODE ALLOWVOLUMEEXPANSION AGE
managed-nfs-storage <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span> fuseim.pri/ifs Delete Immediate false 12m
</code></pre></div><h2 id="65ÈÉ®ÁΩ≤-kubesphere">6.5„ÄÅÈÉ®ÁΩ≤ KubeSphere</h2>
<p>ËøáÁ®ãÂæàÁÆÄÂçïÔºåÂ¶ÇÊûú‰Ω†ÁöÑÊú∫Âô®ËµÑÊ∫êË∂≥Â§üÔºåÂª∫ËÆÆ‰Ω†ËøõË°åÂÆåÊï¥ÂÆâË£ÖÔºåÊìç‰ΩúÊ≠•È™§Â¶Ç‰∏ã„ÄÇÂ¶ÇÊûú‰Ω†ÁöÑËµÑÊ∫ê‰∏çÊòØÂæàÂÖÖË∂≥ÔºåÂàôÂèØ‰ª•ËøõË°åÊúÄÂ∞èÂåñÂÆâË£ÖÔºå<a href="https://kubesphere.com.cn/docs/zh-CN/installation/prerequisites/" target="_blank" rel="noopener noreferrer">ÂèÇËÄÉÂú∞ÂùÄ</a>„ÄÇÊàëÂΩìÁÑ∂ÊòØÈÄâÊã©ÂÆåÊï¥ÂÆâË£Ö‰∫ÜÔºåÈ¶ôÔºÅ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ‰∏ãËΩΩ yaml Êñá‰ª∂</span>
mkdir kubesphere <span style="color:#f92672">&amp;&amp;</span> cd kubesphere
wget https://raw.githubusercontent.com/kubesphere/ks-installer/master/kubesphere-complete-setup.yaml
<span style="color:#75715e"># ÈÉ®ÁΩ≤ KubeSphere</span>
kubectl apply -f kubesphere-complete-setup.yaml
</code></pre></div><p>Ëøô‰∏™ËøáÁ®ãÊ†πÊçÆ‰Ω†ÂÆûÈôÖÁΩëÈÄüÔºåÂÆûÈôÖ‰ΩøÁî®Êó∂Èó¥ÈïøÂ∫¶ÊúâÊâÄ‰∏çÂêå„ÄÇ‰Ω†ÂèØ‰ª•ÈÄöËøáÂ¶Ç‰∏ãÂëΩ‰ª§Êü•ÁúãÂÆûÊó∂ÁöÑÊó•ÂøóËæìÂá∫„ÄÇ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl logs -n kubesphere-system <span style="color:#66d9ef">$(</span>kubectl get pod -n kubesphere-system -l app<span style="color:#f92672">=</span>ks-install -o jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.items[0].metadata.name}&#39;</span><span style="color:#66d9ef">)</span> -f
</code></pre></div><p>ÂΩì‰Ω†ÁúãÂà∞Â¶Ç‰∏ãÊó•ÂøóËæìÂá∫ÔºåËØÅÊòé‰Ω†ÁöÑ KubeSphere ÈÉ®ÁΩ≤ÊàêÂäü</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">**************************************************
task monitoring status is successful
task notification status is successful
task devops status is successful
task alerting status is successful
task logging status is successful
task openpitrix status is successful
task servicemesh status is successful
total: <span style="color:#ae81ff">7</span>     completed:7
**************************************************
<span style="color:#75715e">#####################################################</span>
<span style="color:#75715e">###              Welcome to KubeSphere!           ###</span>
<span style="color:#75715e">#####################################################</span>

Console: http://192.168.115.49:30880
Account: admin
Password: P@88w0rd
<span style="color:#75715e">#####################################################</span>
</code></pre></div><p>Á°ÆËÆ§ Pod ÈÉΩÊ≠£Â∏∏ËøêË°åÂêéÔºåÂèØ‰ΩøÁî®<code>IP:30880</code>ËÆøÈóÆ KubeSphere UI ÁïåÈù¢ÔºåÈªòËÆ§ÁöÑÈõÜÁæ§ÁÆ°ÁêÜÂëòË¥¶Âè∑‰∏∫<code>admin/P@88w0rd</code>ÔºåEnjoy itÔºåüòèÔºÅ</p>
<p><img src="https://92uu-blog.oss-cn-beijing.aliyuncs.com/2020-03-25-103029.png" alt=""></p>
<p><img src="https://92uu-blog.oss-cn-beijing.aliyuncs.com/2020-03-25-145648.png" alt=""></p>
<h2 id="ÂèÇËÄÉ">ÂèÇËÄÉ</h2>
<p>Êú¨ÊñáÂá∫Â§Ñ SegmentfaultÔºö<code>https://segmentfault.com/a/1190000022146020</code></p>

                  </div>
              </div>
              <div class="share-2">
                  <div class="share">
  <a href="http://twitter.com/share?url=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f&text=%e6%89%8b%e6%8a%8a%e6%89%8b%e4%bb%8e%e9%9b%b6%e9%83%a8%e7%bd%b2%e4%b8%8e%e8%bf%90%e8%90%a5%e7%94%9f%e4%ba%a7%e7%ba%a7%e7%9a%84%20Kubernetes%20%e9%9b%86%e7%be%a4%e4%b8%8e%20KubeSphere" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Twitter.svg" alt="twitter icon">
  </a>
  <a href="http://reddit.com/submit?url=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e4%bb%8e%e9%9b%b6%e9%83%a8%e7%bd%b2%e4%b8%8e%e8%bf%90%e8%90%a5%e7%94%9f%e4%ba%a7%e7%ba%a7%e7%9a%84%20Kubernetes%20%e9%9b%86%e7%be%a4%e4%b8%8e%20KubeSphere" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Reddit.svg" alt="reddit icon">
  </a>
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Facebook.svg" alt="facebook icon">
  </a>
  <a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/Linkedin.svg" alt="linkedin icon">
  </a>
  <a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fkubesphere-v3.netlify.app%2fzh%2fblogs%2fkubernetes-kubesphere-ha%2f&t=%e6%89%8b%e6%8a%8a%e6%89%8b%e4%bb%8e%e9%9b%b6%e9%83%a8%e7%bd%b2%e4%b8%8e%e8%bf%90%e8%90%a5%e7%94%9f%e4%ba%a7%e7%ba%a7%e7%9a%84%20Kubernetes%20%e9%9b%86%e7%be%a4%e4%b8%8e%20KubeSphere" target="_blank" rel="noopener noreferrer">
    <img src="/images/share/HackerNews.svg" alt="hackernews icon">
  </a>
</div>
              </div>
          </div>
          <div class='aside'>
              <div class="inner-div">
                <div class='title'>ÁõÆÂΩï</div>
                <div class='tabs'><nav id="TableOfContents">
  <ul>
    <li><a href="#‰∏ÄÂáÜÂ§áÁéØÂ¢É">‰∏Ä„ÄÅÂáÜÂ§áÁéØÂ¢É</a></li>
  </ul>

  <ul>
    <li><a href="#21ÂÆâË£Ö-docker">2.1„ÄÅÂÆâË£Ö Docker</a></li>
    <li><a href="#22‰øÆÊîπ-cgroup-driver">2.2„ÄÅ‰øÆÊîπ Cgroup Driver</a></li>
  </ul>

  <ul>
    <li><a href="#31ÂÆâË£ÖÂáÜÂ§á">3.1„ÄÅÂÆâË£ÖÂáÜÂ§á</a></li>
    <li><a href="#32ÂºÄÂßãÂÆâË£Ö">3.2„ÄÅÂºÄÂßãÂÆâË£Ö</a></li>
  </ul>

  <ul>
    <li><a href="#41ÂàùÂßãÂåñ-control-planemaster-ËäÇÁÇπ">4.1„ÄÅÂàùÂßãÂåñ Control-plane/Master ËäÇÁÇπ</a></li>
    <li><a href="#42ÂÆâË£Ö-pod-ÁΩëÁªúÈôÑÂä†ÁªÑ‰ª∂">4.2„ÄÅÂÆâË£Ö Pod ÁΩëÁªúÈôÑÂä†ÁªÑ‰ª∂</a></li>
    <li><a href="#43Â∞Ü-worker-ËäÇÁÇπÊ∑ªÂä†Âà∞-kubernetes">4.3„ÄÅÂ∞Ü Worker ËäÇÁÇπÊ∑ªÂä†Âà∞ Kubernetes</a></li>
    <li><a href="#44Ê∑ªÂä†-master-ËäÇÁÇπ">4.4„ÄÅÊ∑ªÂä† Master ËäÇÁÇπ</a></li>
    <li><a href="#45Ë°•ÂÖÖÂÜÖÂÆπ">4.5„ÄÅË°•ÂÖÖÂÜÖÂÆπ</a></li>
  </ul>

  <ul>
    <li><a href="#51ÁéØÂ¢ÉËØ¥Êòé">5.1„ÄÅÁéØÂ¢ÉËØ¥Êòé</a></li>
    <li><a href="#52È´òÂèØÁî®Êâ©Â±ï">5.2„ÄÅÈ´òÂèØÁî®Êâ©Â±ï</a></li>
  </ul>

  <ul>
    <li><a href="#61kubesphereÁÆÄ‰ªã">6.1„ÄÅKubeSphereÁÆÄ‰ªã</a></li>
    <li><a href="#62ÂÆâË£ÖË¶ÅÊ±Ç">6.2„ÄÅÂÆâË£ÖË¶ÅÊ±Ç</a></li>
    <li><a href="#63ÂÆâË£Ö-helm">6.3„ÄÅÂÆâË£Ö Helm</a>
      <ul>
        <li><a href="#631helm-ÁÆÄ‰ªã">6.3.1„ÄÅHelm ÁÆÄ‰ªã</a></li>
        <li><a href="#632helmÂÆâË£Ö">6.3.2„ÄÅHelmÂÆâË£Ö</a></li>
      </ul>
    </li>
    <li><a href="#64ÂÆâË£Ö-storageclass">6.4„ÄÅÂÆâË£Ö StorageClass</a>
      <ul>
        <li><a href="#641‰∏ãËΩΩÊâÄÈúÄÊñá‰ª∂">6.4.1„ÄÅ‰∏ãËΩΩÊâÄÈúÄÊñá‰ª∂</a></li>
      </ul>
    </li>
    <li><a href="#642ÈÉ®ÁΩ≤ÂàõÂª∫">6.4.2„ÄÅÈÉ®ÁΩ≤ÂàõÂª∫</a>
      <ul>
        <li><a href="#643Ê†áËÆ∞‰∏Ä‰∏™ÈªòËÆ§ÁöÑ-storageclass">6.4.3„ÄÅÊ†áËÆ∞‰∏Ä‰∏™ÈªòËÆ§ÁöÑ StorageClass</a></li>
      </ul>
    </li>
    <li><a href="#65ÈÉ®ÁΩ≤-kubesphere">6.5„ÄÅÈÉ®ÁΩ≤ KubeSphere</a></li>
    <li><a href="#ÂèÇËÄÉ">ÂèÇËÄÉ</a></li>
  </ul>
</nav></div>
              </div>
          </div>
      </div>
  </section>
  <footer>
    
    <div class="footer">
        <div class="footer-main common-layout">
            <div class="up-main">
                <div class="left-div">
                    <img src="/images/logo.svg" alt="" class="foot-logo">
                    <p>ÈÄöËøáÈÇÆ‰ª∂Êé•Êî∂ KubeSphere ÊúÄÊñ∞ÁöÑÊäÄÊúØÂçöÂÆ¢‰∏é‰∫ßÂìÅÊõ¥Êñ∞ÁöÑÈÄöÁü•</p>
                    <div>
                        <form
                            action="https://kubesphere.us10.list-manage.com/subscribe/post?u=c85ea2b944b08b951f607bdd4&amp;id=83f673a2d9"
                            method="post"
                            target="_blank"
                            novalidate
                        >
                            <input name="EMAIL" id="email-input" type="text" placeholder='ËØ∑ËæìÂÖ•‰Ω†ÁöÑÈÇÆÁÆ±Âú∞ÂùÄ'>
                            <button type="submit" id="email-submit">ËÆ¢ÈòÖ</button>
                        </form>
                    </div>
                    <span id="message" data-message1='ËØ∑Êèê‰æõÊÇ®ÁöÑÈÇÆÁÆ±' data-message2='ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ!'></span>
                </div>
                <div class="right-div">
                    <ul class="common-flex-layout">
                        
                        
                            <li>
                                <div class="h3">Â∫îÁî®Âú∫ÊôØ</div>
                                
                                
                                <a href="/zh/devops/">Êã•Êä±‰∏ÄÁ´ôÂºè DevOps</a>
                                
                                
                                
                                <a href="/zh/service-mesh/">Âú® K8s ËøêË°åÂæÆÊúçÂä°</a>
                                
                                
                                
                                <a href="/zh/observability/">ÊûÑÂª∫‰∫ëÂéüÁîüÂèØËßÇÂØüÊÄß</a>
                                
                                
                                
                                <a href="https://porterlb.io" target="_blank" rel="noopener noreferrer">Áâ©ÁêÜÊú∫ K8s Êö¥Èú≤ÊúçÂä°</a>
                                
                                
                                
                                <a href="https://github.com/kubesphere/kubekey" target="_blank" rel="noopener noreferrer">K8s ‰∏ÄÈîÆÈÉ®ÁΩ≤‰∏éËøêÁª¥</a>
                                
                                
                                
                                <a href="https://openpitrix.io/" target="_blank" rel="noopener noreferrer">Â§ö‰∫ëÂ∫îÁî®ÁÆ°ÁêÜÂπ≥Âè∞</a>
                                
                                
                                
                                <a href="https://github.com/kubesphere/fluentbit-operator" target="_blank" rel="noopener noreferrer">Fluent-Bit ÁÆ°ÁêÜÊó•Âøó</a>
                                
                                
                            </li>
                        
                            <li>
                                <div class="h3">ËµÑÊ∫ê</div>
                                
                                
                                <a href="/zh/projects/">ÂºÄÊ∫êÈ°πÁõÆ</a>
                                
                                
                                
                                <a href="/zh/blogs/">ÊäÄÊúØÂçöÂÆ¢</a>
                                
                                
                                
                                <a href="/zh/conferences/">ÂºÄÊ∫êÂ≥∞‰ºö</a>
                                
                                
                                
                                <a href="/zh/videos/">ËßÜÈ¢ëËµÑÊ∫ê</a>
                                
                                
                            </li>
                        
                            <li>
                                <div class="h3">ÊñáÊ°£‰∏≠ÂøÉ</div>
                                
                                
                                <a href="/../../zh/docs/introduction/what-is-kubesphere/">‰∫ßÂìÅ‰ªãÁªç</a>
                                
                                
                                
                                <a href="/../../zh/docs/quick-start/all-in-one-on-linux/">Â¶Ç‰ΩïÂÆâË£Ö</a>
                                
                                
                                
                                <a href="/../../zh/docs/quick-start/create-workspace-and-project/">Âø´ÈÄüÂÖ•Èó®</a>
                                
                                
                                
                                <a href="/../../docs/api-reference/api-docs/">API ÊñáÊ°£</a>
                                
                                
                            </li>
                        
                            <li>
                                <div class="h3">ÂºÄÊ∫êÁ§æÂå∫</div>
                                
                                
                                <a href="/zh/contribution">ÂèÇ‰∏éË¥°ÁåÆ</a>
                                
                                
                                
                                <a href="/zh/case/">Ê°à‰æãÂ≠¶‰π†</a>
                                
                                
                                
                                <a href="/zh/partner/">Âêà‰Ωú‰ºô‰º¥</a>
                                
                                
                                
                                <a href="https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md" target="_blank" rel="noopener noreferrer">ÁâàÊú¨ËÆ°Âàí</a>
                                
                                
                                
                                <a href="https://kubesphere.com.cn/" target="_blank" rel="noopener noreferrer">‰∏≠ÂõΩÁ´ô</a>
                                
                                
                                
                                <a href="https://kubesphere.com.cn/forum" target="_blank" rel="noopener noreferrer">‰∏≠ÊñáËÆ∫Âùõ</a>
                                
                                
                                
                                <a href="https://kubesphere.io" target="_blank" rel="noopener noreferrer">ÂÖ®ÁêÉÁ´ô</a>
                                
                                
                                
                                <a href="https://kubesphere.eu" target="_blank" rel="noopener noreferrer">Ê¨ßÊ¥≤Á´ô</a>
                                
                                
                                
                                <a href="https://kubesphereturkey.com" target="_blank" rel="noopener noreferrer">ÂúüËÄ≥ÂÖ∂Á´ô</a>
                                
                                
                                
                                <a href="https://kubesphere.es" target="_blank" rel="noopener noreferrer">Ë•øÁè≠ÁâôÁ´ô</a>
                                
                                
                            </li>
                        
                        
                    </ul>
                </div>
            </div>
            <div class="down-main">
                <div class='img-div'>
                    <a class='wechat' href="javascript:void(0);">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="28" height="28" viewBox="0 0 28 28">
    <defs>
        <path id="a" d="M0 0h15.673v12.156H0z"/>
    </defs>
    <g fill="none" fill-rule="evenodd" transform="translate(1 1)">
        <circle cx="13" cy="13" r="13" stroke="#B6C2CD"/>
        <g transform="translate(5 7)">
            <mask id="b" fill="#fff">
                <use xlink:href="#a"/>
            </mask>
            <path fill="currentColor" d="M15.673 7.898c0-2.061-2.173-3.74-4.619-3.74-2.59 0-4.625 1.679-4.625 3.74 0 2.066 2.035 3.738 4.625 3.738.542 0 1.09-.13 1.632-.256l1.493.776-.408-1.29c1.09-.776 1.902-1.81 1.902-2.968zm-6.119-.645c-.27 0-.541-.257-.541-.514 0-.256.27-.514.541-.514.41 0 .681.258.681.514 0 .257-.271.514-.681.514zm2.994 0c-.27 0-.541-.257-.541-.514 0-.256.27-.514.54-.514.41 0 .681.258.681.514 0 .257-.277.514-.68.514z" mask="url(#b)"/>
            <path fill="currentColor" d="M10.602 3.674c.177 0 .356.011.533.029C10.657 1.576 8.27 0 5.543 0 2.498 0 0 1.974 0 4.485c0 1.45.829 2.64 2.216 3.564l-.552 1.588 1.94-.929c.693.129 1.251.263 1.94.263.17 0 .343-.005.515-.022a3.68 3.68 0 0 1-.172-1.104c0-2.302 2.081-4.171 4.715-4.171zM7.618 2.243c.417 0 .693.263.693.66s-.276.66-.693.66c-.418 0-.835-.263-.835-.66.006-.398.423-.66.835-.66zm-3.88 1.319c-.417 0-.834-.263-.834-.66s.417-.66.834-.66c.418 0 .695.263.695.66 0 .392-.277.66-.695.66z" mask="url(#b)"/>
        </g>
    </g>
</svg>

                        <div class="hide-div">
                            <p>Follow the official account</p>
                            <img src="/images/footer/wechat_code.svg" alt="">
                        </div>
                    </a>
                    <a class='facebook-a' href="https://www.facebook.com/kubesphere" target="_blank"></a>
                    <a class='twitter-a' href="https://twitter.com/KubeSphere" target="_blank" rel="noopener noreferrer"></a>
                    <a class='linkedin-a' href="https://www.linkedin.com/company/kubesphere/" target="_blank" rel="noopener noreferrer"></a>
                    
                    <a class='youtube-a' href="https://www.youtube.com/channel/UCyTdUQUYjf7XLjxECx63Hpw" target="_blank" rel="noopener noreferrer"></a>
                    <a class='slack-a' href="https://join.slack.com/t/kubesphere/shared_invite/enQtNTE3MDIxNzUxNzQ0LTZkNTdkYWNiYTVkMTM5ZThhODY1MjAyZmVlYWEwZmQ3ODQ1NmM1MGVkNWEzZTRhNzk0MzM5MmY4NDc3ZWVhMjE" target="_blank" rel="noopener noreferrer"></a>
                    <a class='github-a' href="https://github.com/kubesphere/kubesphere" target="_blank" rel="noopener noreferrer"></a>
                    <a class='medium-a' href="https://itnext.io/@kubesphere" target="_blank" rel="noopener noreferrer"></a>
                </div>
                <p class='p1'>KubeSphere¬ÆÔ∏è 2020 All Rights Reserved.</p>
                
            </div>
        </div>
    </div>

</footer>

<script>
    var bindSubmit = function() {
        var input = $('#email-input')
        $('#email-submit').click(function(event) {
            event.stopPropagation()
            var email = input.val()
            var message1 = $('#message').data('message1')
            var message2 = $('#message').data('message2')
            if (!email) {
                event.preventDefault()
                showMessage(message1)
            } else if (!validateEmail(email)) {
                event.preventDefault()
                showMessage(message2)
            }
        })
    }

    var bindHideMessage = function() {
        $(window).click(function() {
            $('#message').hide()
        })
    }

    var showMessage = function(message) {
        $('#message').html(message).show()
    }

    var validateEmail = function(email) {
        var reg = /^[A-Za-z0-9]+([_\.][A-Za-z0-9]+)*@([A-Za-z0-9\-]+\.)+[A-Za-z]{2,6}$/
        return reg.test(email)
    }

    var lazyLoad = function(allImg, imgNum) {
        for (var i = 0; i < imgNum; i++) {
            var img = allImg.eq(i)
            var loaded = img.attr("data-loaded");
            if (loaded) {
                continue
            }
            if (img.offset().top < parseInt($(window).height()) + parseInt($(window).scrollTop())) {
                var src = img.attr("src")
                img.attr("src", src)
                img.attr("data-loaded", true)
            }
        }
    }

    var bindLayLoad = function() {
        var allImg = $('img')
        var imgNum = allImg.length
        lazyLoad(allImg, imgNum)
        $(window).scroll(function() {
            lazyLoad(allImg, imgNum)
        });
    }

    
    bindSubmit()
    bindHideMessage()
</script>

  
  
  <script type="text/javascript" src="/js/aside.34d4ca232760855916fede489417772adb45cdceab8541c6f6826e5d83a0b68e071a44f76a077fe90e39afe213cc1aab40272900f7cbdffb45068c7746c7b183.js" integrity="sha512-NNTKIydghVkW/t5IlBd3KttFzc6rhUHG9oJuXYOgto4HGkT3agd/6Q45r&#43;ITzBqrQCcpAPfL3/tFBox3Rsexgw=="></script>
  
  
  
  <script type="text/javascript" src="/js/markdown-tab.224c8a343197870e80877ad07e19b932b807d3fde3abccde667f2156378cb00497ebb11d2f872f09ea91e7282e87655f8cb4ef163da46e34d00dca44dbf52aad.js" integrity="sha512-IkyKNDGXhw6Ah3rQfhm5MrgH0/3jq8zeZn8hVjeMsASX67EdL4cvCeqR5yguh2VfjLTvFj2kbjTQDcpE2/UqrQ=="></script>
  
  <script>
    var viewer = new Viewer(document.querySelector('.md-body'), {
        url: 'src'
    })
  </script>
</body>

</html>
